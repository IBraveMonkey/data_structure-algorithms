### üåâ –ü–∞—Ç—Ç–µ—Ä–Ω Bridge-Channel

**Bridge-channel** ‚Äî —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω, –∫–æ—Ç–æ—Ä—ã–π "–≤—ã—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç" (flattening) –ø–æ—Ç–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –≤ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞–Ω–∞–ª, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥—Ä—É–≥–∏–µ –∫–∞–Ω–∞–ª—ã (`<-chan <-chan interface{}`), –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –Ω–∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∫–∞–∫ –µ—Å–ª–∏ –±—ã —ç—Ç–æ –±—ã–ª –æ–¥–∏–Ω –æ–±—ã—á–Ω—ã–π –∫–∞–Ω–∞–ª.

---

### üß† –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ—Å–∞–¥–∫—É –≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç—É. –ü–∞—Å—Å–∞–∂–∏—Ä—ã –ø—Ä–∏–±—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–º–∏ —Ä–µ–π—Å–∞–º–∏ (–≤—Ö–æ–¥—è—â–∏–µ –∫–∞–Ω–∞–ª—ã), –Ω–æ –≤—Å–µ –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ –æ–¥–∏–Ω —É–∑–∫–∏–π –∫–æ—Ä–∏–¥–æ—Ä –ø–∞—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è (—Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –ø–æ—Ç–æ–∫), —á—Ç–æ–±—ã –ø–æ–ø–∞—Å—Ç—å –≤ –≥–æ—Ä–æ–¥.

```mermaid
graph TD
    CS[Channel Stream] -->|Stream 1| B((Bridge))
    CS -->|Stream 2| B
    CS -->|Stream 3| B
    B --> Out[Simplified Value Stream]
```

---

### üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ Bridge —Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –∫–∞–Ω–∞–ª–æ–≤ –∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç–º–µ–Ω—ã, —á—Ç–æ–±—ã –Ω–µ –¥–æ–ø—É—Å—Ç–∏—Ç—å —É—Ç–µ—á–µ–∫ –≥–æ—Ä—É—Ç–∏–Ω.

```go
package main

import "fmt"

// bridge –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –ø–æ—Ç–æ–∫ –∫–∞–Ω–∞–ª–æ–≤ –≤ –æ–¥–∏–Ω –ø–æ—Ç–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π
// bridge flattens a stream of channels into a single value stream
func bridge(done <-chan interface{}, chanStream <-chan (<-chan interface{})) <-chan interface{} {
	valStream := make(chan interface{})
	go func() {
		defer close(valStream)
		for {
			var stream <-chan interface{}
			select {
			case maybeStream, ok := <-chanStream:
				if !ok {
					return
				}
				stream = maybeStream
			case <-done:
				return
			}

			// –ß–∏—Ç–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞
			// Reading values from the currently received channel
			for val := range stream {
				select {
				case valStream <- val:
				case <-done:
					return
				}
			}
		}
	}()
	return valStream
}

func main() {
	done := make(chan interface{})
	defer close(done)

	// –°–æ–∑–¥–∞–µ–º "–∫–∞–Ω–∞–ª –∫–∞–Ω–∞–ª–æ–≤"
	// Creating a "channel of channels"
	chanStream := make(chan (<-chan interface{}))

	go func() {
		defer close(chanStream)
		for i := 0; i < 3; i++ {
			stream := make(chan interface{})
			go func(v int) {
				defer close(stream)
				stream <- fmt.Sprintf("–î–∞–Ω–Ω—ã–µ –∏–∑ –∫–∞–Ω–∞–ª–∞ %d", v)
			}(i)
			chanStream <- stream
		}
	}()

	fmt.Println("–ß—Ç–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –º–æ—Å—Ç...")
	// Reading through the bridge...

	for val := range bridge(done, chanStream) {
		fmt.Printf("–ü–æ–ª—É—á–µ–Ω–æ: %v\n", val)
	}
}
```

---

### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –∫–∞–Ω–∞–ª—ã –≤ –ø–æ—Ç–æ–∫–µ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, `bridge` —á–∏—Ç–∞–µ—Ç –∏–∑ –Ω–∏—Ö –ø–æ –æ—á–µ—Ä–µ–¥–∏, —Å–æ—Ö—Ä–∞–Ω—è—è –ø–æ—Ä—è–¥–æ–∫ –ø–æ—è–≤–ª–µ–Ω–∏—è –∫–∞–Ω–∞–ª–æ–≤.
2. **–£–ø—Ä–æ—â–µ–Ω–∏–µ**: –í—ã–∑—ã–≤–∞—é—â–µ–º—É –∫–æ–¥—É –Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –æ —Å–ª–æ–∂–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏ –∫–∞–Ω–∞–ª–æ–≤, –æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–æ—Å—Ç—ã–º –ø–æ—Ç–æ–∫–æ–º –¥–∞–Ω–Ω—ã—Ö.
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –í—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ `done`.

> [!NOTE]
> –≠—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–≤—è–∑–∫–µ —Å –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏, —Ç–∞–∫–∏–º–∏ –∫–∞–∫ Pipeline, –∫–æ–≥–¥–∞ –æ–¥–∏–Ω –∏–∑ —ç—Ç–∞–ø–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–¥-–∑–∞–¥–∞—á–∏ –≤ –≤–∏–¥–µ –∫–∞–Ω–∞–ª–æ–≤.
