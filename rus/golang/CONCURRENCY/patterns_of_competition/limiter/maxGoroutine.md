### üßµ Limiter: Max Goroutines

**Max Goroutines Limiter** ‚Äî —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω, –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–π –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å–µ–∫—Ü–∏–∏ –∫–æ–¥–∞. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—É–ª–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤, –≥–¥–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –∂–∏–≤—É—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –∑–¥–µ—Å—å –≥–æ—Ä—É—Ç–∏–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–¥ –∫–∞–∂–¥—É—é –∑–∞–¥–∞—á—É, –Ω–æ –∏—Ö –æ–±—â–µ–µ —á–∏—Å–ª–æ —Å—Ç—Ä–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç—Å—è —Å–µ–º–∞—Ñ–æ—Ä–æ–º.

---

### üß† –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –Ω–æ—á–Ω–æ–π –∫–ª—É–± —Å —Ñ–µ–π—Å-–∫–æ–Ω—Ç—Ä–æ–ª–µ–º. –û—Ö—Ä–∞–Ω–Ω–∏–∫ (—Å–µ–º–∞—Ñ–æ—Ä) –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –≤–Ω—É—Ç—Ä—å —Ç–æ–ª—å–∫–æ 100 —á–µ–ª–æ–≤–µ–∫. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤—ã—Ö–æ–¥–∏—Ç, —Å–ª–µ–¥—É—é—â–∏–π –º–æ–∂–µ—Ç –∑–∞–π—Ç–∏. –í–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥—ã–π –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–≤–æ–∏–º –¥–µ–ª–æ–º (–≥–æ—Ä—É—Ç–∏–Ω–∞ –ø–æ–¥ –∑–∞–¥–∞—á—É), –Ω–æ –æ–±—â–µ–µ —á–∏—Å–ª–æ –ª—é–¥–µ–π –≤ –∑–∞–ª–µ –≤—Å–µ–≥–¥–∞ –Ω–µ –±–æ–ª—å—à–µ –ª–∏–º–∏—Ç–∞.

```mermaid
graph TD
    Tasks[Tasks Incoming] --> Gate{Semaphore: 100}
    Gate -->|Enter| G1[New Goroutine]
    Gate -->|Enter| G2[New Goroutine]
    Gate -->|Wait| G3[Pending...]
    G1 -->|Exit| Done[Task Completed]
    Done -.->|Release Slot| Gate
```

---

### üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ù–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–º–∞—Ñ–æ—Ä–∞ –Ω–∞ –±–∞–∑–µ –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞.

```go
package main

import (
	"fmt"
	"sync"
	"time"
)

func main() {
	const maxGoroutines = 5 // –õ–∏–º–∏—Ç –≥–æ—Ä—É—Ç–∏–Ω
	const totalTasks = 15

	// –°–µ–º–∞—Ñ–æ—Ä: –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å
	// Semaphore: the limiter
	sem := make(chan struct{}, maxGoroutines)
	var wg sync.WaitGroup

	fmt.Printf("–û–±—Ä–∞–±–æ—Ç–∫–∞ %d –∑–∞–¥–∞—á —Å –ª–∏–º–∏—Ç–æ–º –≤ %d –≥–æ—Ä—É—Ç–∏–Ω...\n", totalTasks, maxGoroutines)
	// Processing 15 tasks with a limit of 5 goroutines...

	for i := 1; i <= totalTasks; i++ {
		wg.Add(1)

		// –ó–∞–Ω–∏–º–∞–µ–º —Å–ª–æ—Ç –ü–ï–†–ï–î –∑–∞–ø—É—Å–∫–æ–º –≥–æ—Ä—É—Ç–∏–Ω—ã
		// Occupy a slot BEFORE starting the goroutine
		sem <- struct{}{}

		go func(taskID int) {
			defer wg.Done()
			// –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å–ª–æ—Ç –ü–†–ò –ó–ê–í–ï–†–®–ï–ù–ò–ò –≥–æ—Ä—É—Ç–∏–Ω—ã
			// Release the slot ON COMPLETION of the goroutine
			defer func() { <-sem }()

			fmt.Printf("–ó–∞–ø—É—â–µ–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –¥–ª—è –∑–∞–¥–∞—á–∏ %d\n", taskID)
			time.Sleep(time.Duration(200) * time.Millisecond) // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
		}(i)
	}

	wg.Wait()
	fmt.Println("–í—Å–µ –∑–∞–¥–∞—á–∏ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω—ã.")
}
```

---

### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–î–∏–Ω–∞–º–∏—á–Ω–æ—Å—Ç—å**: –ì–æ—Ä—É—Ç–∏–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –∏ —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∏ –ø–æ—Å—Ç—É–ø–∞—é—Ç —Ä–µ–¥–∫–æ.
2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**: –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –æ–±–µ—Ä–Ω—É—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ü–∏–∫–ª –∑–∞–ø—É—Å–∫–∞ –≥–æ—Ä—É—Ç–∏–Ω –≤ —ç—Ç–æ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω.
3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞—â–∏—â–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç –ø–∞–¥–µ–Ω–∏—è –∏–∑-–∑–∞ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ç–µ–∫–∞ (`out of memory`) –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –≥–æ—Ä—É—Ç–∏–Ω.

> [!CAUTION]
> –í—Å–µ–≥–¥–∞ –∑–∞–Ω–∏–º–∞–π—Ç–µ —Å–ª–æ—Ç –≤ —Å–µ–º–∞—Ñ–æ—Ä–µ **–≤–Ω–µ** –≥–æ—Ä—É—Ç–∏–Ω—ã, –∏–Ω–∞—á–µ –≤—ã —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–ª–ª–∏–æ–Ω –≥–æ—Ä—É—Ç–∏–Ω, –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–º –æ–Ω–∏ –Ω–∞—á–Ω—É—Ç –ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–Ω—è—Ç—å —Å–ª–æ—Ç—ã, —á—Ç–æ –ª–∏—à–∏—Ç –ø–∞—Ç—Ç–µ—Ä–Ω —Å–º—ã—Å–ª–∞.
