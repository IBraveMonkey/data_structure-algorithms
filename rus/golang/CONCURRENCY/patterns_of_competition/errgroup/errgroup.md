### ‚ùå –ü–∞—Ç—Ç–µ—Ä–Ω ErrGroup

**ErrGroup** ‚Äî —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è `sync.WaitGroup`, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ —Ç–æ–ª—å–∫–æ –∂–¥–µ—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≥—Ä—É–ø–ø—ã –≥–æ—Ä—É—Ç–∏–Ω, –Ω–æ –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–≤—É—é –≤–æ–∑–Ω–∏–∫—à—É—é –æ—à–∏–±–∫—É. –ï—Å–ª–∏ –æ–¥–Ω–∞ –∏–∑ –≥–æ—Ä—É—Ç–∏–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É, `ErrGroup` –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω –≤ –≥—Ä—É–ø–ø–µ.

---

### üß† –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–≠—Ç–æ –∫–∞–∫ –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º. –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç (–≥–æ—Ä—É—Ç–∏–Ω–∞) –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –ø—Ä–æ–±–ª–µ–º—É (–æ—à–∏–±–∫—É), –æ–Ω —Å–æ–æ–±—â–∞–µ—Ç –æ–± —ç—Ç–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä—É (ErrGroup), –∫–æ—Ç–æ—Ä—ã–π —Ç—É—Ç –∂–µ –¥–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –≤—Å–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–º –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å —Ä–∞–±–æ—Ç—É, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–µ–∫—Ç –±–æ–ª—å—à–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ.

```mermaid
graph TD
    EG[ErrGroup Manager] --> G1[Goroutine 1]
    EG --> G2[Goroutine 2]
    EG --> G3[Goroutine 3]
    G2 -- "Returns Error" --> EG
    EG -- "Cancel Context" ---> G1
    EG -- "Cancel Context" ---> G3
```

---

### üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `ErrGroup` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç `golang.org/x/sync/errgroup`.

```go
package main

import (
	"context"
	"fmt"
	"time"

	"golang.org/x/sync/errgroup"
)

func main() {
	// –°–æ–∑–¥–∞–µ–º ErrGroup –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–º–µ–Ω–∏—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–µ
	// Creating ErrGroup and a context that cancels on the first error
	g, ctx := errgroup.WithContext(context.Background())

	urls := []string{"site1.com", "site2.com", "error-site.com", "site3.com"}

	for _, url := range urls {
		url := url // capturing variable for closure
		g.Go(func() error {
			// –ò–º–∏—Ç–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞
			// Simulating a request
			select {
			case <-time.After(500 * time.Millisecond):
				if url == "error-site.com" {
					return fmt.Errorf("–æ—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –∫ %s", url)
				}
				fmt.Printf("–£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ %s\n", url)
				return nil
			case <-ctx.Done():
				// –ü—Ä–µ—Ä—ã–≤–∞–µ–º —Ä–∞–±–æ—Ç—É, –µ—Å–ª–∏ –¥—Ä—É–≥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞ –æ—à–∏–±–∫—É
				// Aborting if another goroutine returned an error
				return ctx.Err()
			}
		})
	}

	// –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∏–ª–∏ –ø–µ—Ä–≤–æ–π –æ—à–∏–±–∫–∏
	// Waiting for completion or the first error
	if err := g.Wait(); err != nil {
		fmt.Printf("–ì—Ä—É–ø–ø–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å —Å –æ—à–∏–±–∫–æ–π: %v\n", err)
	} else {
		fmt.Println("–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
	}
}
```

---

### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å–∞–º–∞—è –ø–µ—Ä–≤–∞—è –≤–æ–∑–Ω–∏–∫—à–∞—è –æ—à–∏–±–∫–∞. –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–∞—Å–∫–∏—Ä—É—é—Ç—Å—è.
2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞–º–∏**: –° –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `SetLimit(n)` –º–æ–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω.
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**: –ë–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–Ω–∞–ª—ã –¥–ª—è —Å–±–æ—Ä–∞ –æ—à–∏–±–æ–∫ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω.

> [!IMPORTANT]
> `ErrGroup` –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—è–∑–∞–Ω –±—ã—Ç—å —É—Å–ø–µ—à–Ω—ã–º –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.
