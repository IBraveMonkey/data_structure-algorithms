### üö¶ –ü–∞—Ç—Ç–µ—Ä–Ω Semaphore (–°–µ–º–∞—Ñ–æ—Ä)

**Semaphore** ‚Äî —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –∏–ª–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–º—É —Ä–µ—Å—É—Ä—Å—É. –í Go —Å–µ–º–∞—Ñ–æ—Ä —á–∞—â–µ –≤—Å–µ–≥–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞, –≥–¥–µ —Ä–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ "—Å–ª–æ—Ç–æ–≤" (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π).

---

### üß† –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ –ø–∞—Ä–∫–æ–≤–∫—É –Ω–∞ 3 –º–µ—Å—Ç–∞. –ö–æ–≥–¥–∞ –º–∞—à–∏–Ω–∞ –∑–∞–µ–∑–∂–∞–µ—Ç, –æ–Ω–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –æ–¥–Ω–æ –º–µ—Å—Ç–æ (–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –∫–∞–Ω–∞–ª). –ï—Å–ª–∏ –º–µ—Å—Ç –Ω–µ—Ç, —Å–ª–µ–¥—É—é—â–∞—è –º–∞—à–∏–Ω–∞ –∂–¥–µ—Ç —É —à–ª–∞–≥–±–∞—É–º–∞. –ö–æ–≥–¥–∞ –º–∞—à–∏–Ω–∞ —É–µ–∑–∂–∞–µ—Ç, –º–µ—Å—Ç–æ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç—Å—è (—á–∏—Ç–∞–µ–º –∏–∑ –∫–∞–Ω–∞–ª–∞), –∏ —Å–ª–µ–¥—É—é—â–∞—è –º–∞—à–∏–Ω–∞ –º–æ–∂–µ—Ç –∑–∞–µ—Ö–∞—Ç—å.

```mermaid
graph TD
    S[Resource Source] -->Gate{Semaphore: Limit 3}
    Gate -->|Slot 1| G1[Goroutine]
    Gate -->|Slot 2| G2[Goroutine]
    Gate -->|Slot 3| G3[Goroutine]
    G4[Goroutine 4] -.->|Wait| Gate
```

---

### üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ–º–∞—Ñ–æ—Ä–∞ –≤ Go —á–µ—Ä–µ–∑ –ø—É—Å—Ç–æ–π `struct{}` –≤ –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–º –∫–∞–Ω–∞–ª–µ.

```go
package main

import (
	"fmt"
	"sync"
	"time"
)

func main() {
	const goroutineLimit = 3
	tasks := []int{1, 2, 3, 4, 5, 6, 7}

	wg := sync.WaitGroup{}
	// –°–µ–º–∞—Ñ–æ—Ä: –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –Ω–∞ 3 —ç–ª–µ–º–µ–Ω—Ç–∞
	// Semaphore: buffered channel with 3 slots
	sem := make(chan struct{}, goroutineLimit)

	for _, task := range tasks {
		wg.Add(1)
		
		// –ó–∞–Ω–∏–º–∞–µ–º —Å–ª–æ—Ç: –µ—Å–ª–∏ –∫–∞–Ω–∞–ª –ø–æ–ª–æ–Ω, –±–ª–æ–∫–∏—Ä—É–µ–º—Å—è
		// Occupy a slot: blocks if the channel is full
		sem <- struct{}{}

		go func(id int) {
			defer wg.Done()
			// –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å–ª–æ—Ç –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
			// Release the slot on completion
			defer func() { <-sem }()

			fmt.Printf("–í–æ—Ä–∫–µ—Ä %d –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É...\n", id)
			time.Sleep(1 * time.Second) // –ò–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
			fmt.Printf("–í–æ—Ä–∫–µ—Ä %d –∑–∞–∫–æ–Ω—á–∏–ª.\n", id)
		}(task)
	}

	wg.Wait()
	fmt.Println("–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.")
}
```

---

### üí° –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

1. **–ì–∏–±–∫–æ—Å—Ç—å**: –í—ã –º–æ–∂–µ—Ç–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—Ç—å –ª–∏–º–∏—Ç, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏.
2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å–ª–æ–∂–Ω—ã—Ö –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —è–∑—ã–∫–∞.
3. **–í–µ—Å–∞ (Weighted Semaphores)**: –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ —Ç—Ä–µ–±—É—é—Ç —Ä–∞–∑–Ω–æ–≥–æ "–≤–µ—Å–∞" (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –∑–∞–Ω–∏–º–∞–µ—Ç 2 —Å–ª–æ—Ç–∞), –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç `golang.org/x/sync/semaphore`.

> [!TIP]
> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –°–µ–º–∞—Ñ–æ—Ä, –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ –≤–Ω–µ—à–Ω—é—é —Å–∏—Å—Ç–µ–º—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –±–æ–ª–µ–µ 5 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö).
