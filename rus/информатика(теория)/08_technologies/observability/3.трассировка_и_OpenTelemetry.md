# üß∂ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –∏ OpenTelemetry

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ß—Ç–æ —Ç–∞–∫–æ–µ –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞?](#—á—Ç–æ-—Ç–∞–∫–æ–µ-—Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞)
2. [Span –∏ Trace: –ë–∞–∑–æ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è](#span-–∏-trace)
3. [–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Jaeger –∏ Zipkin)](#–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
4. [OpenTelemetry (OTel): –ë—É–¥—É—â–µ–µ](#opentelemetry-otel)
5. [–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Ç–∏ –∑–∞–ø—Ä–æ—Å–∞](#–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)

---

## ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞?

–í –º–æ–Ω–æ–ª–∏—Ç–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –∑–∞–ø—Ä–æ—Å —Ç–æ—Ä–º–æ–∑–∏—Ç. –í –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –ø—Ä–æ–π—Ç–∏ —á–µ—Ä–µ–∑ 10 —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤. üè¢

**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ (Distributed Tracing)** –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –≤–µ—Å—å –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –Ω–∞—á–∞–ª–∞ –¥–æ –∫–æ–Ω—Ü–∞ –∏ –ø–æ–Ω—è—Ç—å, –Ω–∞ –∫–∞–∫–æ–º –∏–º–µ–Ω–Ω–æ —ç—Ç–∞–ø–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –∏–ª–∏ –æ—à–∏–±–∫–∞.

---

## üß© Span –∏ Trace

- **Trace (–¢—Ä–∞—Å—Å–∞)**: –í–µ—Å—å –ø—É—Ç—å –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É. –≠—Ç–æ –∫–æ–ª–ª–µ–∫—Ü–∏—è —Å–ø–∞–Ω–æ–≤.
- **Span (–°–ø–∞–Ω)**: –û–¥–Ω–∞ –µ–¥–∏–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, "–≤—ã–∑–æ–≤ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö" –∏–ª–∏ "–≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ API". üìè

–£ –∫–∞–∂–¥–æ–≥–æ —Å–ø–∞–Ω–∞ –µ—Å—Ç—å:
- –ù–∞–∑–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏.
- –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏ –∫–æ–Ω—Ü–∞.
- **Trace ID**: –û–±—â–∏–π –¥–ª—è –≤—Å–µ–π —Ü–µ–ø–æ—á–∫–∏ –∑–∞–ø—Ä–æ—Å–∞.
- **Parent ID**: –°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç—Ç–∞–ø.

---

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

1.  **Jaeger**: –°–∞–º—ã–π –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ —Å –æ—Ç–ª–∏—á–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –ø–æ–∏—Å–∫–∞ "—Ç–æ—Ä–º–æ–∑—è—â–∏—Ö" —É—á–∞—Å—Ç–∫–æ–≤. üèéÔ∏è
2.  **Zipkin**: –ö–ª–∞—Å—Å–∏–∫–∞ –∂–∞–Ω—Ä–∞, –æ–¥–∏–Ω –∏–∑ –ø–µ—Ä–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.

---

## üåê OpenTelemetry (OTel)

–≠—Ç–æ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –∫–æ–Ω—Ü–µ–ø—Ç –Ω–∞ —Å–µ–≥–æ–¥–Ω—è. –†–∞–Ω—å—à–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ (Prometheus, Jaeger, ELK) –Ω—É–∂–Ω–æ –±—ã–ª–æ –ø–∏—Å–∞—Ç—å —Ä–∞–∑–Ω—ã–π –∫–æ–¥ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

**OpenTelemetry** ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∏ –Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫. –í—ã –æ–¥–∏–Ω —Ä–∞–∑ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ OTel –≤ —Å–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∞ –æ–Ω —Å–∞–º —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –º–µ—Ç—Ä–∏–∫–∏, –∏ –ª–æ–≥–∏, –∏ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏, –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ –ª—é–±–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –ø–æ –≤–∞—à–µ–º—É –≤—ã–±–æ—Ä—É. üõ†Ô∏è‚ú®

---

## üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```mermaid
sequenceDiagram
    participant U as User
    participant A as API Gateway
    participant S as Order Service
    participant D as Database
    
    U->>A: Create Order (Trace Start)
    Note over A: Span 1: Auth
    A->>S: Request Order Creation
    Note over S: Span 2: Validation
    S->>D: Save to DB
    Note over D: Span 3: SQL INSERT
    D-->>S: OK
    S-->>A: OK
    A-->>U: 201 Created (Trace End)
```

---

## üåü –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

> [!IMPORTANT]
> **–¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ ‚Äî —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±:**
> - –ù–∞–π—Ç–∏ "—É–∑–∫–æ–µ –º–µ—Å—Ç–æ" (bottleneck) –≤ —Ü–µ–ø–æ—á–∫–µ –∏–∑ –¥–µ—Å—è—Ç–∫–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤. üîç
> - –ü–æ–Ω—è—Ç—å, –∫–∞–∫ –∫–∞—Å–∫–∞–¥–Ω–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –æ—à–∏–±–∫–∏ (–æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å —É–ø–∞–ª -> —É–ø–∞–ª–∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ).
> - –£–≤–∏–¥–µ—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É —Å–∏—Å—Ç–µ–º—ã "–≥–ª–∞–∑–∞–º–∏" –∑–∞–ø—Ä–æ—Å–∞.

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

> [!TIP]
> 1. **Context Propagation**: –°–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ –≤ —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–µ ‚Äî –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å Trace ID –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ (–æ–±—ã—á–Ω–æ —á–µ—Ä–µ–∑ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏). –í Go –¥–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `context.Context`.
> 2. **Sampling (–°—ç–º–ø–ª–∏–Ω–≥)**: –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ ‚Äî –¥–æ—Ä–æ–≥–∞—è —à—Ç—É–∫–∞. –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—É—Ç—å *–∫–∞–∂–¥–æ–≥–æ* –∑–∞–ø—Ä–æ—Å–∞. –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ 1% –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö. üìâ
