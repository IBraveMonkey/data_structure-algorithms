# üåê TLS/SSL: –ó–∞—â–∏—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—É—Ç–∏

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ß—Ç–æ —Ç–∞–∫–æ–µ TLS –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?](#—á—Ç–æ-—Ç–∞–∫–æ–µ-tls)
2. [–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ vs –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ)](#—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ)
3. [TLS Handshake (–†—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ)](#tls-handshake)
4. [–¶–∏—Ñ—Ä–æ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (CA)](#—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã)
5. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Go](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–Ω–∞-go)

---

## ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ TLS –∏ –∑–∞—á–µ–º –æ–Ω –Ω—É–∂–µ–Ω?

**TLS (Transport Layer Security)** ‚Äî —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª, –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã—Ö –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º (–±—Ä–∞—É–∑–µ—Ä–æ–º) –∏ —Å–µ—Ä–≤–µ—Ä–æ–º. –ï–≥–æ –ø—Ä–µ–¥—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫–æ–º –±—ã–ª **SSL**, –Ω–æ —Å–µ–≥–æ–¥–Ω—è –Ω–∞–∑–≤–∞–Ω–∏–µ SSL —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ –ø—Ä–∏–≤—ã—á–∫–µ –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è TLS. üõ°Ô∏è

–û–Ω —Ä–µ—à–∞–µ—Ç —Ç—Ä–∏ –∑–∞–¥–∞—á–∏:
1.  **–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ**: –î–∞–Ω–Ω—ã–µ –Ω–µ–ª—å–∑—è –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–µ.
2.  **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ –æ–±—â–∞–µ—Ç–µ—Å—å –∏–º–µ–Ω–Ω–æ —Å —Ç–µ–º —Å–µ—Ä–≤–µ—Ä–æ–º, —Å –∫–æ—Ç–æ—Ä—ã–º —Ö–æ—Ç–µ–ª–∏.
3.  **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å**: –î–∞–Ω–Ω—ã–µ –Ω–µ –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω—ã –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –ø–µ—Ä–µ–¥–∞—á–∏.

### –ó–∞—á–µ–º —ç—Ç–æ –≤–∞–∂–Ω–æ?

**–ë–µ–∑ TLS (HTTP):**
- –ü–∞—Ä–æ–ª–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º
- –õ—é–±–æ–π –≤ —Å–µ—Ç–∏ Wi-Fi –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å –≤–∞—à —Ç—Ä–∞—Ñ–∏–∫
- –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ (Man-in-the-Middle attack)

**–° TLS (HTTPS):**
- –í—Å—ë –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ
- –¢–æ–ª—å–∫–æ –≤—ã –∏ —Å–µ—Ä–≤–µ—Ä –∑–Ω–∞–µ—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
- –ó–µ–ª–µ–Ω—ã–π –∑–∞–º–æ—á–µ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä–µ ‚úÖ

---

## üîë –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

TLS –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–∞ –≤–∏–¥–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

### 1. –ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ (–ü—É–±–ª–∏—á–Ω—ã–π + –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á–∏)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ, —á—Ç–æ–±—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–æ–≥–æ–≤–æ—Ä–∏—Ç—å—Å—è –æ —Å–µ–∫—Ä–µ—Ç–Ω–æ–º –∫–ª—é—á–µ. –≠—Ç–æ –º–µ–¥–ª–µ–Ω–Ω–æ, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –£ —Å–µ—Ä–≤–µ—Ä–∞ –µ—Å—Ç—å –ø–∞—Ä–∞ –∫–ª—é—á–µ–π: –ø—É–±–ª–∏—á–Ω—ã–π (–≤—Å–µ–º –≤–∏–¥–µ–Ω) –∏ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π)
- –ö–ª–∏–µ–Ω—Ç —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º
- –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å (–ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º)

### 2. –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ (–û–¥–∏–Ω –æ–±—â–∏–π –∫–ª—é—á)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ. ‚ö°

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏
- –û–±–∞ (–∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä) –∑–Ω–∞—é—Ç —ç—Ç–æ—Ç –∫–ª—é—á
- –í 1000 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ

| –¢–∏–ø | –°–∫–æ—Ä–æ—Å—Ç—å | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∫–ª—é—á–∞ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ TLS |
|:---|:---:|:---:|:---|
| **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ** | üê¢ –ú–µ–¥–ª–µ–Ω–Ω–æ | ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ | –ù–∞—á–∞–ª–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |
| **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ** | üöÄ –ë—ã—Å—Ç—Ä–æ | ‚ùå –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ | –û—Å–Ω–æ–≤–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö |

---

## ü§ù TLS Handshake (–†—É–∫–æ–ø–æ–∂–∞—Ç–∏–µ)

–≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å "–∑–Ω–∞–∫–æ–º—Å—Ç–≤–∞" –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö:

```mermaid
sequenceDiagram
    participant Client as –ö–ª–∏–µ–Ω—Ç<br/>(–ë—Ä–∞—É–∑–µ—Ä)
    participant Server as –°–µ—Ä–≤–µ—Ä
    
    Client->>Server: 1. Client Hello<br/>(–≤–µ—Ä—Å–∏–∏ TLS, —Å–ø–∏—Å–æ–∫ —à–∏—Ñ—Ä–æ–≤)
    Server->>Client: 2. Server Hello + –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç<br/>(—Å –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º)
    Note over Client: 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞<br/>–≤ –£–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–µ–º —Ü–µ–Ω—Ç—Ä–µ (CA)
    Client->>Server: 4. Client Key Exchange<br/>(–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—â–∏–π –∫–ª—é—á)
    Note over Server: 5. –î–µ—à–∏—Ñ—Ä–æ–≤–∫–∞ –æ–±—â–µ–≥–æ –∫–ª—é—á–∞
    Client->>Server: 6. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    Server->>Client: 7. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é!
    Note over Client, Server: ‚úÖ –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω<br/>(–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ)
```

### –î–µ—Ç–∞–ª–∏ —à–∞–≥–æ–≤:

1. **Client Hello**: –ö–ª–∏–µ–Ω—Ç –≥–æ–≤–æ—Ä–∏—Ç "–Ø –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é TLS 1.3, –≤–æ—Ç –º–æ–∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è"
2. **Server Hello**: –°–µ—Ä–≤–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞**: –ö–ª–∏–µ–Ω—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∞–Ω –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º CA (Let's Encrypt, DigiCert)
4. **Key Exchange**: –ö–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –∫–ª—é—á, —à–∏—Ñ—Ä—É–µ—Ç –µ–≥–æ –ø—É–±–ª–∏—á–Ω—ã–º –∫–ª—é—á–æ–º —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
5. **–ì–æ—Ç–æ–≤–æ**: –û–±–∞ –∑–Ω–∞—é—Ç –æ–±—â–∏–π —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á, –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –Ω–∞ –±—ã—Å—Ç—Ä–æ–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

---

## üìú –¶–∏—Ñ—Ä–æ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã (CA)

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä `google.com` —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ Google, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **–¶–µ–Ω—Ç—Ä—ã –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Certificate Authorities)**. 

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. Google —Å–æ–∑–¥–∞–µ—Ç –ø–∞—Ä—É –∫–ª—é—á–µ–π (–ø—É–±–ª–∏—á–Ω—ã–π + –ø—Ä–∏–≤–∞—Ç–Ω—ã–π)
2. Google –ø—Ä–æ—Å–∏—Ç **Let's Encrypt** (CA) –ø–æ–¥–ø–∏—Å–∞—Ç—å –µ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
3. Let's Encrypt –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ Google –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤–ª–∞–¥–µ–µ—Ç –¥–æ–º–µ–Ω–æ–º
4. Let's Encrypt –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–≤–æ–∏–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–º –∫–ª—é—á–æ–º
5. –í–∞—à –±—Ä–∞—É–∑–µ—Ä –¥–æ–≤–µ—Ä—è–µ—Ç Let's Encrypt (—Å–ø–∏—Å–æ–∫ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö CA –≤—Å—Ç—Ä–æ–µ–Ω –≤ –±—Ä–∞—É–∑–µ—Ä)
6. –ë—Ä–∞—É–∑–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å ‚Äî –µ—Å–ª–∏ –≤—Å—ë –û–ö, –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–º–æ—á–µ–∫ ‚úÖ

```mermaid
flowchart TD
    Server["–°–µ—Ä–≤–µ—Ä (example.com)"] -->|1. –°–æ–∑–¥–∞–µ—Ç CSR| CA["Certificate Authority<br/>(Let's Encrypt)"]
    CA -->|2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–ª–∞–¥–µ–Ω–∏–µ –¥–æ–º–µ–Ω–æ–º| Domain["DNS / HTTP –ø—Ä–æ–≤–µ—Ä–∫–∞"]
    CA -->|3. –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç| Cert["–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç"]
    Cert -->|4. –û—Ç–¥–∞–µ—Ç —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç| Server
    Browser["–ë—Ä–∞—É–∑–µ—Ä"] -->|5. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å CA| Trusted["–î–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ CA<br/>(–≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä)"]
    Trusted -->|6. –ü–æ–¥–ø–∏—Å—å –≤–∞–ª–∏–¥–Ω–∞| Lock["üîí –ó–µ–ª–µ–Ω—ã–π –∑–∞–º–æ—á–µ–∫"]
    
    style Lock fill:#90EE90
```

---

## üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Go

### 1. HTTPS —Å–µ—Ä–≤–µ—Ä —Å TLS

```go
package main

import (
    "fmt"
    "log"
    "net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, "Secure Hello from HTTPS server!")
}

func main() {
    http.HandleFunc("/", handler)
    
    // –ó–∞–ø—É—Å–∫ HTTPS —Å–µ—Ä–≤–µ—Ä–∞
    // –ù—É–∂–Ω—ã –¥–≤–∞ —Ñ–∞–π–ª–∞: server.crt (—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç) –∏ server.key (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á)
    log.Println("Starting HTTPS server on :443")
    err := http.ListenAndServeTLS(":443", "server.crt", "server.key", nil)
    if err != nil {
        log.Fatal("ListenAndServeTLS: ", err)
    }
}
```

---

### 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
openssl genrsa -out server.key 2048

# –°–æ–∑–¥–∞–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (—Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π, –¥–ª—è dev)
openssl req -new -x509 -key server.key -out server.crt -days 365
```

> [!WARNING]
> –°–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –ø–æ–¥—Ö–æ–¥—è—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏! –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Let's Encrypt**.

---

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TLS –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```go
import (
    "crypto/tls"
    "net/http"
)

func main() {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TLS
    tlsConfig := &tls.Config{
        MinVersion: tls.VersionTLS13,  // –ú–∏–Ω–∏–º—É–º TLS 1.3
        CipherSuites: []uint16{
            tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,
            tls.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,
        },
    }
    
    server := &http.Server{
        Addr:      ":443",
        Handler:   nil,
        TLSConfig: tlsConfig,
    }
    
    log.Fatal(server.ListenAndServeTLS("server.crt", "server.key"))
}
```

---

### 4. TLS –∫–ª–∏–µ–Ω—Ç (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞)

```go
import (
    "crypto/tls"
    "crypto/x509"
    "io/ioutil"
    "net/http"
)

func makeSecureRequest() error {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ—Ä–Ω–µ–≤—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã CA
    caCert, err := ioutil.ReadFile("ca.crt")
    if err != nil {
        return err
    }
    
    caCertPool := x509.NewCertPool()
    caCertPool.AppendCertsFromPEM(caCert)
    
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TLS –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞
    tlsConfig := &tls.Config{
        RootCAs: caCertPool,
        MinVersion: tls.VersionTLS12,
    }
    
    client := &http.Client{
        Transport: &http.Transport{
            TLSClientConfig: tlsConfig,
        },
    }
    
    resp, err := client.Get("https://example.com")
    if err != nil {
        return err
    }
    defer resp.Body.Close()
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
    if resp.TLS != nil {
        fmt.Println("TLS Version:", resp.TLS.Version)
        fmt.Println("Cipher Suite:", resp.TLS.CipherSuite)
        fmt.Println("Server Name:", resp.TLS.ServerName)
    }
    
    return nil
}
```

---

### 5. Let's Encrypt —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

```go
import (
    "golang.org/x/crypto/acme/autocert"
    "net/http"
)

func main() {
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –æ—Ç Let's Encrypt
    certManager := autocert.Manager{
        Prompt:     autocert.AcceptTOS,
        HostPolicy: autocert.HostWhitelist("example.com", "www.example.com"),
        Cache:      autocert.DirCache("certs"), // –ü–∞–ø–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
    }
    
    server := &http.Server{
        Addr: ":443",
        TLSConfig: &tls.Config{
            GetCertificate: certManager.GetCertificate,
        },
    }
    
    // –¢–∞–∫–∂–µ –Ω—É–∂–µ–Ω HTTP —Å–µ—Ä–≤–µ—Ä –Ω–∞ :80 –¥–ª—è ACME challenge
    go http.ListenAndServe(":80", certManager.HTTPHandler(nil))
    
    log.Fatal(server.ListenAndServeTLS("", ""))
}
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ TLS 1.3** (–∏–ª–∏ –º–∏–Ω–∏–º—É–º 1.2)
2. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** (Let's Encrypt + autocert)
3. **HSTS –∑–∞–≥–æ–ª–æ–≤–æ–∫**: –ë—Ä–∞—É–∑–µ—Ä –±—É–¥–µ—Ç –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS
   ```go
   w.Header().Set("Strict-Transport-Security", "max-age=31536000; includeSubDomains")
   ```
4. **–û—Ç–∫–ª—é—á–∏—Ç–µ —Å—Ç–∞—Ä—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã**: –ù–∏–∫–∞–∫–∏—Ö RC4, MD5, SHA1

### ‚ùå –ß–µ–≥–æ –ù–ï –¥–µ–ª–∞—Ç—å:

1. **–ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –æ—à–∏–±–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤**
   ```go
   // ‚ùå –ü–õ–û–•–û: –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤!
   tlsConfig := &tls.Config{
       InsecureSkipVerify: true,
   }
   ```

2. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTP –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
3. **–ù–µ –ø–µ—Ä–µ–º–µ—â–∞–π—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏ –ø–æ email/Slack**

---

## üí° –ò—Ç–æ–≥

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|:---|:---|:---|
| **TLS/SSL** | –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–∞ | –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–ª—É—à–∫–∏ |
| **Handshake** | –û–±–º–µ–Ω –∫–ª—é—á–∞–º–∏ | –ù–∞—á–∞–ª–æ —Å–µ—Å—Å–∏–∏ |
| **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ª–∏—á–Ω–æ—Å—Ç–∏ | –ò–∑–±–µ–∂–∞—Ç—å MITM |
| **CA** | –£–¥–æ—Å—Ç–æ–≤–µ—Ä—è—é—â–∏–π —Ü–µ–Ω—Ç—Ä | Let's Encrypt, DigiCert |
| **–ê—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ** | –ú–µ–¥–ª–µ–Ω–Ω–æ–µ, –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ | –û–±–º–µ–Ω –∫–ª—é—á–æ–º |
| **–°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µfast**, –±—ã—Å—Ç—Ä–æ–µ | –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö |

> [!CAUTION]
> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ "–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ –∑–∞—â–∏—â–µ–Ω–æ". –≠—Ç–æ –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å, —á—Ç–æ –∫—Ç–æ-—Ç–æ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç—å –≤–∞—à —Ç—Ä–∞—Ñ–∏–∫ (–∞—Ç–∞–∫–∞ Man-in-the-Middle). ‚ö†Ô∏è
