# ๐ ะะฐะฑะปัะดะฐะตะผะพััั (Observability) ะธ Prometheus

## ๐ ะกะพะดะตัะถะฐะฝะธะต
1. [ะขัะธ ััะพะปะฟะฐ ะะฐะฑะปัะดะฐะตะผะพััะธ](#ััะธ-ััะพะปะฟะฐ-ะฝะฐะฑะปัะดะฐะตะผะพััะธ)
2. [Prometheus: ะงัะพ ััะพ?](#prometheus-ััะพ-ััะพ)
3. [ะะฐะบ ัะฐะฑะพัะฐะตั Prometheus (Pull vs Push)](#ะฐััะธัะตะบัััะฐ-ะธ-ะฟัะธะฝัะธะฟ-ัะฐะฑะพัั)
4. [ะัะฝะพะฒะฝัะต ัะธะฟั ะผะตััะธะบ](#ัะธะฟั-ะผะตััะธะบ)
5. [ะัะฝะพะฒั PromQL](#ะพัะฝะพะฒั-promql)

---

## ๐๏ธ ะขัะธ ััะพะปะฟะฐ ะะฐะฑะปัะดะฐะตะผะพััะธ

**ะะฐะฑะปัะดะฐะตะผะพััั (Observability)** โ ััะพ ะผะตัะฐ ัะพะณะพ, ะฝะฐัะบะพะปัะบะพ ัะพัะพัะพ ะฒั ะผะพะถะตัะต ะฟะพะฝััั ะฒะฝัััะตะฝะฝะตะต ัะพััะพัะฝะธะต ะฒะฐัะตะน ัะธััะตะผั, ะฟัะพััะพ ะณะปัะดั ะฝะฐ ะตั ะฒะฝะตัะฝะธะต ะดะฐะฝะฝัะต. 

ะกััะตััะฒัะตั "ะทะพะปะพัะฐั ััะพะนะบะฐ" ะดะฐะฝะฝัั ะดะปั ััะพะณะพ:
1.  **ะะตััะธะบะธ (Metrics)** โ ะงะธัะปะฐ. ะกะบะพะปัะบะพ ะทะฐะฟัะพัะพะฒ ะฒ ัะตะบัะฝะดั? ะกะบะพะปัะบะพ ะฟะฐะผััะธ ะทะฐะฝััะพ? (Prometheus).
2.  **ะะพะณะธ (Logs)** โ ะขะตะบัั. ะงัะพ ะธะผะตะฝะฝะพ ะฟัะพะธะทะพัะปะพ ะฒ ะบะพะฝะบัะตัะฝัะน ะผะพะผะตะฝั? (ELK).
3.  **ะขัะฐััะธัะพะฒะบะธ (Traces)** โ ะััั. ะงะตัะตะท ะบะฐะบะธะต ัะตัะฒะธัั ะฟัะพัะตะป ะทะฐะฟัะพั ะฟะพะปัะทะพะฒะฐัะตะปั? (Jaeger).

---

## ๐ Prometheus: ะงัะพ ััะพ?

**Prometheus** โ ััะพ ััะฐะฝะดะฐัั ะดะต-ัะฐะบัะพ ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ ัะพะฒัะตะผะตะฝะฝัั ัะธััะตะผ. ๐๏ธ

- **Time Series Database (TSDB)**: ะะฝ ััะฐะฝะธั ะดะฐะฝะฝัะต ะบะฐะบ ะฒัะตะผะตะฝะฝัะต ััะดั (ะทะฝะฐัะตะฝะธะต + ะฒัะตะผั).
- **ะะฝะพะณะพะผะตัะฝัะต ะดะฐะฝะฝัะต**: ะะตััะธะบะธ ะธะดะตะฝัะธัะธัะธัััััั ะฟะพ ะธะผะตะฝะธ ะธ ะฝะฐะฑะพัั ะผะตัะพะบ (labels), ะฝะฐะฟัะธะผะตั: `http_requests_total{method="post", code="200"}`.

---

## โ๏ธ ะััะธัะตะบัััะฐ ะธ ะฟัะธะฝัะธะฟ ัะฐะฑะพัั

ะกะฐะผะพะต ะฒะฐะถะฝะพะต ะพัะปะธัะธะต Prometheus โ ะพะฝ ะธัะฟะพะปัะทัะตั **Pull-ะผะพะดะตะปั**.

```mermaid
graph LR
    P[Prometheus Server] -- "1. Pull (HTTP /metrics)" --> Target1[App Service A]
    P -- "Pull" --> Target2[App Service B]
    Target1 -- "Expose" --> E1[Client Library]
    P -- "Store" --> TSDB[(Local Storage)]
    P -- "Query" --> G[Grafana]
    
    subgraph "Pull Model"
    P
    Target1
    Target2
    end
```

- **Prometheus** ัะฐะผ ะพะฑัะฐัะฐะตััั ะบ ะฒะฐัะธะผ ัะตัะฒะธัะฐะผ ัะฐะท ะฒ ะฝะตัะบะพะปัะบะพ ัะตะบัะฝะด ะธ ะทะฐะฑะธัะฐะตั (ัะบัะตะนะฟะธั) ะดะฐะฝะฝัะต.
- **Pushgateway**: ะัะฟะพะปัะทัะตััั ัะพะปัะบะพ ะดะปั ะบะพัะพัะบะพะถะธะฒััะธั ะทะฐะดะฐั (ัะบัะธะฟัะพะฒ), ะบะพัะพััะต ะฝะต ะผะพะณัั ะถะดะฐัั, ะฟะพะบะฐ ะธั "ะพะฟัะพััั".

---

## ๐ข ะขะธะฟั ะผะตััะธะบ

ะ Prometheus ะตััั 4 ะพัะฝะพะฒะฝัั ัะธะฟะฐ ะดะฐะฝะฝัั:
1.  **Counter (ะกัะตััะธะบ)**: ะขะพะปัะบะพ ัะฐััะตั (ะธะปะธ ัะฑัะฐััะฒะฐะตััั ะฒ 0). ะัะธะผะตั: ะบะพะปะธัะตััะฒะพ ะทะฐะฟัะพัะพะฒ, ะพัะธะฑะพะบ. ๐
2.  **Gauge (ะะฐััะธะบ)**: ะะพะถะตั ะธ ัะฐััะธ, ะธ ะฟะฐะดะฐัั. ะัะธะผะตั: ัะตะผะฟะตัะฐัััะฐ, ะทะฐะณััะทะบะฐ CPU, ะบะพะปะธัะตััะฒะพ ะฐะบัะธะฒะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน. ๐ก๏ธ
3.  **Histogram (ะะธััะพะณัะฐะผะผะฐ)**: ะกัะธัะฐะตั ะบะพะปะธัะตััะฒะพ ัะพะฑััะธะน ะฒ ะพะฟัะตะดะตะปะตะฝะฝัั ะดะธะฐะฟะฐะทะพะฝะฐั (ะฑะฐะบะตัะฐั). ะะพะปะตะทะฝะพ ะดะปั ะธะทะผะตัะตะฝะธั ะทะฐะดะตัะถะตะบ (latency).
4.  **Summary (ะกะฒะพะดะบะฐ)**: ะะพัะพะถะต ะฝะฐ ะณะธััะพะณัะฐะผะผั, ะฝะพ ััะธัะฐะตั ะบะฒะฐะฝัะธะปะธ ะฝะฐ ััะพัะพะฝะต ะบะปะธะตะฝัะฐ.

---

## ๐ ะัะฝะพะฒั PromQL

**PromQL** โ ััะพ ัะทัะบ ะทะฐะฟัะพัะพะฒ Prometheus. 
ะัะธะผะตั: *"ะะฐะน ะผะฝะต ััะตะดะฝะธะน ัะตะผะฟ ัะพััะฐ ะทะฐะฟัะพัะพะฒ ะทะฐ ะฟะพัะปะตะดะฝะธะต 5 ะผะธะฝัั"*
```promql
rate(http_requests_total[5m])
```

---

> [!TIP]
> **ะะปะฐะฒะฝัะน ัะพะฒะตั**: ะะต ะผะพะฝะธัะพัััะต ะฒัั ะฟะพะดััะด. ะัะฟะพะปัะทัะนัะต **"Four Golden Signals"**: 
> - **Latency** (ะะฐะดะตัะถะบะฐ)
> - **Traffic** (ะขัะฐัะธะบ)
> - **Errors** (ะัะธะฑะบะธ)
> - **Saturation** (ะะฐัััะตะฝะฝะพััั/ะะตััััั) ๐ก๏ธ
