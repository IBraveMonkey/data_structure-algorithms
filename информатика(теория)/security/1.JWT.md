# üìÑ JWT (JSON Web Tokens): –ü–∞—Å–ø–æ—Ä—Ç –¥–ª—è –≤–∞—à–µ–≥–æ API

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ß—Ç–æ —Ç–∞–∫–æ–µ JWT?](#—á—Ç–æ-—Ç–∞–∫–æ–µ-jwt)
2. [–ê–Ω–∞—Ç–æ–º–∏—è —Ç–æ–∫–µ–Ω–∞ (Header, Payload, Signature)](#–∞–Ω–∞—Ç–æ–º–∏—è-—Ç–æ–∫–µ–Ω–∞)
3. [–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç)
4. [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Go](#—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–Ω–∞-go)
5. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–∏-—Ö—Ä–∞–Ω–µ–Ω–∏–µ)

---

## ‚ùì –ß—Ç–æ —Ç–∞–∫–æ–µ JWT?

**JWT (JSON Web Token)** ‚Äî —ç—Ç–æ –æ—Ç–∫—Ä—ã—Ç—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–µ–∂–¥—É —Å—Ç–æ—Ä–æ–Ω–∞–º–∏ –≤ –≤–∏–¥–µ –æ–±—ä–µ–∫—Ç–∞ JSON. –≠—Ç–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è **–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ–π**, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∞ –ø–æ–¥–ø–∏—Å–∞–Ω–∞ —Ü–∏—Ñ—Ä–æ–≤–æ–π –ø–æ–¥–ø–∏—Å—å—é. üõ°Ô∏è

–û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤—ã–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é JWT, –∫–æ—Ç–æ—Ä—ã–π —Ç–æ—Ç –ø—Ä–∏–∫—Ä–µ–ø–ª—è–µ—Ç –∫ –∫–∞–∂–¥–æ–º—É —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–ø—Ä–æ—Å—É.

### –ó–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ?

**–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (Session):**
- –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏–∏ –≤ –ø–∞–º—è—Ç–∏/–ë–î
- –ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç Session ID –≤ –∫—É–∫–µ
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å–µ—Ä–≤–µ—Ä –∏—â–µ—Ç —Å–µ—Å—Å–∏—é –≤ –ë–î

**JWT –ø–æ–¥—Ö–æ–¥ (Stateless):**
- –°–µ—Ä–≤–µ—Ä –Ω–µ —Ö—Ä–∞–Ω–∏—Ç –Ω–∏—á–µ–≥–æ
- –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Å–∞–º–æ–º —Ç–æ–∫–µ–Ω–µ
- –ë—ã—Å—Ç—Ä–µ–µ, –ª–µ–≥—á–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å

---

## ü¶¥ –ê–Ω–∞—Ç–æ–º–∏—è —Ç–æ–∫–µ–Ω–∞

JWT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Ç—Ä–µ—Ö —á–∞—Å—Ç–µ–π, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ç–æ—á–∫–∞–º–∏: `header.payload.signature`

### –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª—å–Ω–æ–≥–æ JWT:

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.
eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.
SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

### –¢—Ä–∏ —á–∞—Å—Ç–∏:

1.  **Header (–ó–∞–≥–æ–ª–æ–≤–æ–∫)**: –¢–∏–ø —Ç–æ–∫–µ–Ω–∞ (JWT) –∏ –∞–ª–≥–æ—Ä–∏—Ç–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, HS256 –∏–ª–∏ RS256).
   ```json
   {
     "alg": "HS256",
     "typ": "JWT"
   }
   ```

2.  **Payload (–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞)**: –°–∞–º–∏ –¥–∞–Ω–Ω—ã–µ (Claims). –ù–∞–ø—Ä–∏–º–µ—Ä: `sub` (user ID), `role`, `exp` (–≤—Ä–µ–º—è –∏—Å—Ç–µ—á–µ–Ω–∏—è).
   ```json
   {
     "sub": "1234567890",
     "name": "John Doe",
     "iat": 1516239022,
     "exp": 1516242622
   }
   ```

3.  **Signature (–ü–æ–¥–ø–∏—Å—å)**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —á—Ç–æ —Ç–æ–∫–µ–Ω –Ω–µ –±—ã–ª –∏–∑–º–µ–Ω–µ–Ω.
   ```
   HMACSHA256(
     base64UrlEncode(header) + "." + base64UrlEncode(payload),
     secret
   )
   ```

```mermaid
flowchart LR
    H["Header<br/>(–ê–ª–≥–æ—Ä–∏—Ç–º)"] --> P["Payload<br/>(–î–∞–Ω–Ω—ã–µ)"] --> S["Signature<br/>(–ü–æ–¥–ø–∏—Å—å)"]
    style H fill:#f96
    style P fill:#6f9
    style S fill:#69f
```

---

## ‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç —Å–µ—Å—Å–∏–π, JWT ‚Äî —ç—Ç–æ **Stateless** (–±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ) –º–µ—Ö–∞–Ω–∏–∑–º.

```mermaid
sequenceDiagram
    participant User
    participant Server
    
    User->>Server: POST /login (email, password)
    Note over Server: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫—Ä–µ–¥–æ–≤<br/>–°–æ–∑–¥–∞–Ω–∏–µ JWT
    Server-->>User: JWT Token
    
    User->>Server: GET /profile<br/>Header: Authorization Bearer <TOKEN>
    Note over Server: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏<br/>(–ë–ï–ó –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ë–î!)
    Server-->>User: –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è (200 OK)
```

---

## üíª –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Go

### 1. –°–æ–∑–¥–∞–Ω–∏–µ JWT —Ç–æ–∫–µ–Ω–∞

```go
package main

import (
    "fmt"
    "time"
    "github.com/golang-jwt/jwt/v5"
)

var secretKey = []byte("your-secret-key-here")

// –°–æ–∑–¥–∞–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è claims
type Claims struct {
    UserID uint   `json:"user_id"`
    Email  string `json:"email"`
    Role   string `json:"role"`
    jwt.RegisteredClaims
}

func createToken(userID uint, email, role string) (string, error) {
    // –°–æ–∑–¥–∞–µ–º claims
    claims := Claims{
        UserID: userID,
        Email:  email,
        Role:   role,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.NewNumericDate(time.Now().Add(15 * time.Minute)),
            IssuedAt:  jwt.NewNumericDate(time.Now()),
            Issuer:    "my-app",
        },
    }
    
    // –°–æ–∑–¥–∞–µ–º —Ç–æ–∫–µ–Ω
    token := jwt.NewWithClaims(jwt.SigningMethodHS256, claims)
    
    // –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º
    tokenString, err := token.SignedString(secretKey)
    if err != nil {
        return "", err
    }
    
    return tokenString, nil
}

func main() {
    token, _ := createToken(123, "user@example.com", "admin")
    fmt.Println("JWT Token:", token)
}
```

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ (–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è) JWT —Ç–æ–∫–µ–Ω–∞

```go
func validateToken(tokenString string) (*Claims, error) {
    // –ü–∞—Ä—Å–∏–º —Ç–æ–∫–µ–Ω
    token, err := jwt.ParseWithClaims(tokenString, &Claims{}, func(token *jwt.Token) (interface{}, error) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º
        if _, ok := token.Method.(*jwt.SigningMethodHMAC); !ok {
            return nil, fmt.Errorf("unexpected signing method: %v", token.Header["alg"])
        }
        return secretKey, nil
    })
    
    if err != nil {
        return nil, err
    }
    
    // –ò–∑–≤–ª–µ–∫–∞–µ–º claims
    if claims, ok := token.Claims.(*Claims); ok && token.Valid {
        return claims, nil
    }
    
    return nil, fmt.Errorf("invalid token")
}

func main() {
    tokenString := "eyJhbGciOiJIUzI1..."
    
    claims, err := validateToken(tokenString)
    if err != nil {
        fmt.Println("Token invalid:", err)
        return
    }
    
    fmt.Printf("User ID: %d, Email: %s, Role: %s\n", 
               claims.UserID, claims.Email, claims.Role)
}
```

---

### 3. Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

```go
import (
    "net/http"
    "strings"
)

func authMiddleware(next http.Handler) http.Handler {
    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
        // –ü–æ–ª—É—á–∞–µ–º —Ç–æ–∫–µ–Ω –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization
        authHeader := r.Header.Get("Authorization")
        if authHeader == "" {
            http.Error(w, "Missing authorization header", http.StatusUnauthorized)
            return
        }
        
        // –§–æ—Ä–º–∞—Ç: "Bearer <token>"
        parts := strings.Split(authHeader, " ")
        if len(parts) != 2 || parts[0] != "Bearer" {
            http.Error(w, "Invalid authorization header", http.StatusUnauthorized)
            return
        }
        
        tokenString := parts[1]
        claims, err := validateToken(tokenString)
        if err != nil {
            http.Error(w, "Invalid token", http.StatusUnauthorized)
            return
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —é–∑–µ—Ä–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        ctx := context.WithValue(r.Context(), "user_id", claims.UserID)
        ctx = context.WithValue(ctx, "role", claims.Role)
        
        // –ü–µ—Ä–µ–¥–∞–µ–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–ª—å—à–µ
        next.ServeHTTP(w, r.WithContext(ctx))
    })
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
func protectedHandler(w http.ResponseWriter, r *http.Request) {
    userID := r.Context().Value("user_id").(uint)
    fmt.Fprintf(w, "Hello, user %d!", userID)
}

func main() {
    http.Handle("/protected", authMiddleware(http.HandlerFunc(protectedHandler)))
    http.ListenAndServe(":8080", nil)
}
```

---

### 4. Refresh Token Pattern

Access Token –∫–æ—Ä–æ—Ç–∫–∏–π (15 –º–∏–Ω), Refresh Token –¥–æ–ª–≥–∏–π (–Ω–µ–¥–µ–ª–∏).

```go
func createTokenPair(userID uint, email, role string) (accessToken, refreshToken string, err error) {
    // Access Token (–∫–æ—Ä–æ—Ç–∫–∏–π)
    accessToken, err = createToken(userID, email, role)
    if err != nil {
        return "", "", err
    }
    
    // Refresh Token (–¥–æ–ª–≥–∏–π, —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
    refreshClaims := Claims{
        UserID: userID,
        RegisteredClaims: jwt.RegisteredClaims{
            ExpiresAt: jwt.NewNumericDate(time.Now().Add(7 * 24 * time.Hour)), // 7 –¥–Ω–µ–π
            IssuedAt:  jwt.NewNumericDate(time.Now()),
        },
    }
    
    refreshTokenObj := jwt.NewWithClaims(jwt.SigningMethodHS256, refreshClaims)
    refreshToken, err = refreshTokenObj.SignedString(secretKey)
    if err != nil {
        return "", "", err
    }
    
    return accessToken, refreshToken, nil
}

func refreshAccessToken(refreshTokenString string) (newAccessToken string, err error) {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º refresh token
    claims, err := validateToken(refreshTokenString)
    if err != nil {
        return "", err
    }
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π access token
    newAccessToken, err = createToken(claims.UserID, claims.Email, claims.Role)
    return newAccessToken, err
}
```

---

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

### üö® –û—Å–Ω–æ–≤–Ω—ã–µ —É–≥—Ä–æ–∑—ã:

#### 1. XSS (Cross-Site Scripting)

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –≤ `localStorage`, –µ–≥–æ –º–æ–∂–µ—Ç —É–∫—Ä–∞—Å—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π JS.

**–ó–∞—â–∏—Ç–∞**: –•—Ä–∞–Ω–∏—Ç–µ –≤ **HttpOnly Cookie** (JS –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å).

```go
http.SetCookie(w, &http.Cookie{
    Name:     "jwt",
    Value:    tokenString,
    HttpOnly: true,      // JS –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å
    Secure:   true,      // –¢–æ–ª—å–∫–æ HTTPS
    SameSite: http.SameSiteStrictMode, // –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF
    MaxAge:   3600,      // 1 —á–∞—Å
})
```

#### 2. –£—Ç–µ—á–∫–∞ —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

–ï—Å–ª–∏ `secretKey` —É—Ç–µ–∫–∞–µ—Ç ‚Äî –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª—é–±—ã–µ —Ç–æ–∫–µ–Ω—ã.

**–ó–∞—â–∏—Ç–∞**:
- –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **RS256** (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π) –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

```go
// RS256: –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏, –ø—É–±–ª–∏—á–Ω—ã–π –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
privateKey, _ := rsa.GenerateKey(rand.Reader, 2048)

token := jwt.NewWithClaims(jwt.SigningMethodRS256, claims)
tokenString, _ := token.SignedString(privateKey)

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—Ä—É–≥–æ–º —Å–µ—Ä–≤–∏—Å–µ (—Ç–æ–ª—å–∫–æ –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á)
jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {
    return &privateKey.PublicKey, nil
})
```

#### 3. –¢–æ–∫–µ–Ω –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–æ–∑–≤–∞–Ω

–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —É–∫—Ä–∞–ª–∏ ‚Äî –æ–Ω –≤–∞–ª–∏–¥–µ–Ω –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è.

**–ó–∞—â–∏—Ç–∞**:
- –ö–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏ (15 –º–∏–Ω—É—Ç)
- Blacklist —É–∫—Ä–∞–¥–µ–Ω–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤ (—Ö—Ä–∞–Ω–∏–º –≤ Redis)

```go
var tokenBlacklist = make(map[string]bool)

func revokeToken(tokenString string) {
    tokenBlacklist[tokenString] = true
}

func isTokenRevoked(tokenString string) bool {
    return tokenBlacklist[tokenString]
}
```

---

### –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ?

| –ú–µ—Å—Ç–æ | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | XSS | CSRF |
|:---|:---:|:---:|:---:|
| **LocalStorage** | üî¥ –û–ø–∞—Å–Ω–æ | –£—è–∑–≤–∏–º–æ | –ó–∞—â–∏—â–µ–Ω–æ |
| **SessionStorage** | üî¥ –û–ø–∞—Å–Ω–æ | –£—è–∑–≤–∏–º–æ | –ó–∞—â–∏—â–µ–Ω–æ |
| **HttpOnly Cookie** | üü¢ –ë–µ–∑–æ–ø–∞—Å–Ω–æ | –ó–∞—â–∏—â–µ–Ω–æ | –ù—É–∂–µ–Ω CSRF —Ç–æ–∫–µ–Ω |
| **Memory (JS –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è)** | üü° –°—Ä–µ–¥–Ω–µ | –£—è–∑–≤–∏–º–æ | –ó–∞—â–∏—â–µ–Ω–æ |

### –í–∞–∂–Ω—ã–µ —Å–æ–≤–µ—Ç—ã:

- **–ù–∏–∫–æ–≥–¥–∞** –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã –≤–Ω—É—Ç—Ä–∏ Payload. –ï–≥–æ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª—é–±–æ–π, –ø—Ä–æ—Å—Ç–æ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–≤ Base64.
- **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏ (exp)**: –î–µ–ª–∞–π—Ç–µ –µ–≥–æ –∫–æ—Ä–æ—Ç–∫–∏–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, 15 –º–∏–Ω—É—Ç). –î–ª—è –¥–æ–ª–≥–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Refresh Token**.
- **–ê–ª–≥–æ—Ä–∏—Ç–º—ã**: 
  - `HS256` (—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π) ‚Äî –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤
  - `RS256` (–∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π) ‚Äî –¥–ª—è –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤

---

## üí° –ò—Ç–æ–≥

| –ö–æ–Ω—Ü–µ–ø—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|:---|:---|:---|
| **Header** | –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏ | `{"alg": "HS256", "typ": "JWT"}` |
| **Payload** | –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | `{"sub": "123", "role": "admin"}` |
| **Signature** | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ | `HMACSHA256(header + payload, secret)` |
| **Stateless** | –ë–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å |
| **–°—Ä–æ–∫ –∂–∏–∑–Ω–∏** | Access Token –∫–æ—Ä–æ—Ç–∫–∏–π | 15 –º–∏–Ω—É—Ç (–ª—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞) |

> [!CAUTION]
> –ï—Å–ª–∏ –≤–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ (secret) —É—Ç–µ—á–µ—Ç, –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–∏ —Å–º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª—é–±—ã–µ —Ç–æ–∫–µ–Ω—ã –∏ –∑–∞—Ö–æ–¥–∏—Ç—å –ø–æ–¥ –ª—é–±—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –ë–µ—Ä–µ–≥–∏—Ç–µ –∫–ª—é—á! üóùÔ∏è
