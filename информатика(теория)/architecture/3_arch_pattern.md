# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [Clean / Onion / Hexagonal Architecture](#1-clean--onion--hexagonal-architecture)
2. [CQRS (Command and Query Responsibility Segregation)](#2-cqrs)
3. [Event Driven Architecture](#3-event-driven-architecture)
4. [Saga Pattern](#4-saga-pattern)
5. [S.O.L.I.D. –∏ Dependency Injection](#5-solid-–∏-dependency-injection)

---

## 1. üèóÔ∏è Domain-Centric Architectures (–û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è)

–°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç—Ä–∏ –æ—á–µ–Ω—å –ø–æ—Ö–æ–∂–∏—Ö –ø–æ–¥—Ö–æ–¥–∞: **–ß–∏—Å—Ç–∞—è (Clean)**, **–õ—É–∫–æ–≤–∞—è (Onion)** –∏ **–ì–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è (Hexagonal)** –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. 

> [!IMPORTANT]
> **–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ**: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã **–í–ù–£–¢–†–¨**.
> –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å) –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –∏ **–Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—Ç—å** –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–µ–±–µ –∏–ª–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö. –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ —à—Ç—É–∫–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç.

### ‚¨° 1.1 Hexagonal Architecture (Ports and Adapters)
–ü—Ä–∏–¥—É–º–∞–Ω–∞ –ê–ª–∏—Å—Ç–µ—Ä–æ–º –ö–æ–∫–±–µ—Ä–Ω–æ–º. –ï—ë —Å—É—Ç—å ‚Äî –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å "–Ø–¥—Ä–æ" (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É) –æ—Ç "–í–Ω–µ—à–Ω–µ–≥–æ –º–∏—Ä–∞".

*   **–ü–æ—Ä—Ç—ã (Ports)**: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã (–ø—Ä–æ—Ç–æ–∫–æ–ª—ã), –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç, –∫–∞–∫ –º–∏—Ä –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º (Input) –∏ –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ–±—â–∞—Ç—å—Å—è —Å –º–∏—Ä–æ–º (Output).
*   **–ê–¥–∞–ø—Ç–µ—Ä—ã (Adapters)**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è Postgres, –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è REST API.

```mermaid
flowchart LR
    subgraph External["–í–Ω–µ—à–Ω–∏–π –º–∏—Ä (Infrastructure)"]
        HTTP[HTTP API / CLI]
        Postgres[PostgreSQL DB]
    end
    
    subgraph Hexagon["‚¨° –Ø–¥—Ä–æ (Core)"]
        Domain[Domain Logic]
        Ports[Ports / Interfaces]
    end
    
    HTTP -->|Adapter| Ports
    Ports --> Domain
    Domain --> Ports
    Ports -->|Adapter| Postgres
```

---

### üßÖ 1.2 Onion Architecture (–õ—É–∫–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
–ü—Ä–∏–¥—É–º–∞–Ω–∞ –î–∂–µ—Ñ—Ñ—Ä–∏ –ü–∞–ª–µ—Ä–º–æ. –î–µ–ª–∞–µ—Ç –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Å–ª–æ—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∫–∞–∫ —Å–ª–æ–∏ –ª—É–∫–æ–≤–∏—Ü—ã –æ–±–≤–æ–ª–∞–∫–∏–≤–∞—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞.

*   **–¶–µ–Ω—Ç—Ä (Domain Model)**: –¢–æ–ª—å–∫–æ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞.
*   **Domain Services**: –õ–æ–≥–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –≤–ª–µ–∑–∞–µ—Ç –≤ –æ–¥–Ω—É —Å—É—â–Ω–æ—Å—Ç—å.
*   **Application Services**: –¢–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ –∏ Use Cases (—Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è).

**–í —á–µ–º —Ñ–∏—à–∫–∞?** –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π 3-—Å–ª–æ–π–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ (UI -> Business -> Data) –≤—Å—ë –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –í –õ—É–∫–æ–≤–æ–π ‚Äî –ë–∞–∑–∞ –î–∞–Ω–Ω—ã—Ö –≤—ã–Ω–µ—Å–µ–Ω–∞ –Ω–∞ —Å–∞–º—ã–π –∫—Ä–∞–π.

---

### üèóÔ∏è 1.3 Clean Architecture (–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
–ü–æ–ø—É–ª—è—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ "–î—è–¥–µ–π –ë–æ–±–æ–º" (–†–æ–±–µ—Ä—Ç –ú–∞—Ä—Ç–∏–Ω). –û–Ω–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–¥–µ–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–≤—É—Ö –∏ –¥–µ–ª–∏—Ç –≤—Å—ë –Ω–∞ 4 –∫—Ä—É–≥–∞:

1.  **Entities (–°—É—â–Ω–æ—Å—Ç–∏)**: –ë–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç—ã (–Æ–∑–µ—Ä, –ó–∞–∫–∞–∑).
2.  **Use Cases (–°—Ü–µ–Ω–∞—Ä–∏–∏)**: –û–ø–∏—Å—ã–≤–∞—é—Ç, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑").
3.  **Interface Adapters**: –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, –ü—Ä–µ–∑–µ–Ω—Ç–µ—Ä—ã, –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
4.  **Frameworks & Drivers**: –ë–î, –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏, –≤–Ω–µ—à–Ω–∏–µ API.

---

### üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ç–µ—Ä–º–∏–Ω–æ–≤

| –ß–∏—Å—Ç–∞—è (Clean) | –õ—É–∫–æ–≤–∞—è (Onion) | –ì–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è (Hex) | –ß—Ç–æ —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ? |
| :--- | :--- | :--- | :--- |
| **Entities** | Domain Model | Core/Domain | –°–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ |
| **Use Cases** | Application Services | Core (Input/Output) | –°—Ü–µ–Ω–∞—Ä–∏–π (—á—Ç–æ –Ω–∞–∂–∞—Ç—å, –∫—É–¥–∞ –±–µ–∂–∞—Ç—å) |
| **Interface Adapters** | Adapters / Infrastructure | Adapters | –ü–µ—Ä–µ–≤–æ–¥ —Å —è–∑—ã–∫–∞ JSON –Ω–∞ —è–∑—ã–∫ –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç–æ–≤ |
| **Frameworks** | External World | Infrastructure | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, HTTP, –õ–æ–≥–∏, –§–∞–π–ª—ã |

---

### üíª –ü—Ä–∏–º–µ—Ä: –ö–∞–∫ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –≤ –∫–æ–¥–µ (–Ω–∞ Go)

#### 1. –°–ª–æ–π Domain (–°–∞–º—ã–π —Ü–µ–Ω—Ç—Ä ‚Äî —á–∏—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞)
```go
// domain/order.go
package domain

type Order struct {
    ID      string
    Amount  int
    Status  string
}

// –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –≤–Ω—É—Ç—Ä–∏ –¥–æ–º–µ–Ω–∞
func (o *Order) ApplyDiscount(percent int) {
    o.Amount = o.Amount - (o.Amount * percent / 100)
}
```

#### 2. –°–ª–æ–π Use Case (–°—Ü–µ–Ω–∞—Ä–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
–ó–¥–µ—Å—å –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º **–ß–¢–û** —Å–¥–µ–ª–∞—Ç—å, –Ω–æ –Ω–µ –∑–Ω–∞–µ–º **–ö–ê–ö** —ç—Ç–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –ë–î.
```go
// application/usecase.go
package application

import "myapp/domain"

// –ü–æ—Ä—Ç (–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å) –¥–ª—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
type OrderRepository interface {
    Save(order *domain.Order) error
}

type OrderService struct {
    repo OrderRepository // –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –∞ –Ω–µ –æ—Ç –ë–î!
}

func (s *OrderService) CreateOrder(amount int) error {
    order := &domain.Order{Amount: amount, Status: "New"}
    order.ApplyDiscount(10) // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª–æ–≥–∏–∫—É –¥–æ–º–µ–Ω–∞
    return s.repo.Save(order)
}
```

#### 3. –°–ª–æ–π Infrastructure (–í–Ω–µ—à–Ω–∏–π –º–∏—Ä ‚Äî –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
–ê –≤–æ—Ç —Ç—É—Ç –º—ã –ø–∏—à–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π SQL –∫–æ–¥.
```go
// infrastructure/postgres.go
package infrastructure

import "myapp/domain"

type PostgresRepo struct {
    // —Ç—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
}

// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–≥–æ —Å–∞–º–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏–∑ —Å–ª–æ—è Application
func (r *PostgresRepo) Save(order *domain.Order) error {
    // INSERT INTO orders ...
    return nil
}
```

---

#### 3. üü¢ Interface Adapters (–ê–¥–∞–ø—Ç–µ—Ä—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤)

**–ß—Ç–æ —Ç—É—Ç:**
- **Controllers**: –ü—Ä–∏–Ω–∏–º–∞—é—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã, –≤—ã–∑—ã–≤–∞—é—Ç Use Cases
- **Presenters**: –§–æ—Ä–º–∞—Ç–∏—Ä—É—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç–≤–µ—Ç–∞ (JSON, HTML)
- **Gateways/Repositories**: –†–µ–∞–ª–∏–∑—É—é—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î

**–ü—Ä–∞–≤–∏–ª–æ:** –ü—Ä–µ–≤—Ä–∞—â–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–æ—Ä–º–∞—Ç–∞ –≤–Ω–µ—à–Ω–µ–≥–æ –º–∏—Ä–∞ –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è Use Cases (–∏ –æ–±—Ä–∞—Ç–Ω–æ).

**–ü—Ä–∏–º–µ—Ä –Ω–∞ Go:**
```go
// infrastructure/http/user_controller.go
package http

import (
    "encoding/json"
    "net/http"
    "myapp/application"
)

type UserController struct {
    createUserUseCase *application.CreateUserUseCase
}

func (c *UserController) CreateUser(w http.ResponseWriter, r *http.Request) {
    // 1. –ü–∞—Ä—Å–∏–º –∑–∞–ø—Ä–æ—Å (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –∏–∑ HTTP –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É)
    var req struct {
        Email    string `json:"email"`
        Password string `json:"password"`
    }
    json.NewDecoder(r.Body).Decode(&req)
    
    // 2. –í—ã–∑—ã–≤–∞–µ–º Use Case
    err := c.createUserUseCase.Execute(req.Email, req.Password)
    
    // 3. –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç (–∞–¥–∞–ø—Ç–∞—Ü–∏—è –∏–∑ –æ—à–∏–±–∫–∏ –≤ HTTP)
    if err != nil {
        w.WriteHeader(http.StatusBadRequest)
        json.NewEncoder(w).Encode(map[string]string{"error": err.Error()})
        return
    }
    
    w.WriteHeader(http.StatusCreated)
    json.NewEncoder(w).Encode(map[string]string{"status": "created"})
}
```

```go
// infrastructure/postgres/user_repository.go
package postgres

import (
    "database/sql"
    "myapp/domain"
)

type PostgresUserRepository struct {
    db *sql.DB
}

// –†–µ–∞–ª–∏–∑—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏–∑ Application Layer
func (r *PostgresUserRepository) Save(user *domain.User) error {
    query := "INSERT INTO users (id, email, password, balance) VALUES ($1, $2, $3, $4)"
    _, err := r.db.Exec(query, user.ID, user.Email, user.Password, user.Balance)
    return err
}

func (r *PostgresUserRepository) GetByEmail(email string) (*domain.User, error) {
    var user domain.User
    query := "SELECT id, email, password, balance FROM users WHERE email = $1"
    err := r.db.QueryRow(query, email).Scan(&user.ID, &user.Email, &user.Password, &user.Balance)
    if err != nil {
        return nil, err
    }
    return &user, nil
}
```

---

#### 4. üîµ Frameworks & Drivers (–§—Ä–µ–π–º–≤–æ—Ä–∫–∏ –∏ –î—Ä–∞–π–≤–µ—Ä—ã)

**–ß—Ç–æ —Ç—É—Ç:**
- –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Postgres, MongoDB, Redis)
- –í–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ (Gin, Echo, Chi)
- –í–Ω–µ—à–Ω–∏–µ API, —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞

**–ü—Ä–∞–≤–∏–ª–æ:** –¢–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏. –ù–∏–∫–∞–∫–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏.

```go
// cmd/main.go
package main

import (
    "database/sql"
    "net/http"
    _ "github.com/lib/pq"
    
    "myapp/application"
    httpInfra "myapp/infrastructure/http"
    "myapp/infrastructure/postgres"
)

func main() {
    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î (Frameworks Layer)
    db, _ := sql.Open("postgres", "connection_string")
    
    // 2. –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (Interface Adapters)
    userRepo := &postgres.PostgresUserRepository{db: db}
    
    // 3. –°–æ–∑–¥–∞–Ω–∏–µ Use Case (Application Layer)
    createUserUseCase := application.NewCreateUserUseCase(userRepo)
    
    // 4. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ (Interface Adapters)
    userController := &httpInfra.UserController{
        createUserUseCase: createUserUseCase,
    }
    
    // 5. –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (Frameworks Layer)
    http.HandleFunc("/users", userController.CreateUser)
    http.ListenAndServe(":8080", nil)
}
```

---

### üî∑ Hexagonal Architecture (–ü–æ—Ä—Ç—ã –∏ –ê–¥–∞–ø—Ç–µ—Ä—ã)

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ** Clean Architecture. –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è —Ç–∞ –∂–µ, –Ω–æ —Å –¥—Ä—É–≥–æ–π —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–µ–π:

- **–ü–æ—Ä—Ç (Port)** ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `UserRepository`)
- **–ê–¥–∞–ø—Ç–µ—Ä (Adapter)** ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `PostgresUserRepository`)

```mermaid
flowchart LR
    subgraph External["–í–Ω–µ—à–Ω–∏–π –º–∏—Ä"]
        HTTP[HTTP API]
        Postgres[PostgreSQL]
        Redis[Redis Cache]
    end
    
    subgraph Hexagon["‚¨° –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è<br/>(–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)"]
        Domain[Domain Entities]
        UseCases[Use Cases]
    end
    
    HTTP -->|Adapter| PortIn["Input Port<br/>(Interface)"]
    PortIn --> UseCases
    
    UseCases --> PortOut["Output Port<br/>(Interface)"]
    PortOut -->|Adapter| Postgres
    PortOut -->|Adapter| Redis
```

**–ü–ª—é—Å—ã:**
- –õ–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å Postgres –Ω–∞ MongoDB (–ø—Ä–æ—Å—Ç–æ –¥—Ä—É–≥–æ–π –∞–¥–∞–ø—Ç–µ—Ä)
- –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–∏—Å–ø–æ–ª—å–∑—É–µ–º mock –∞–¥–∞–ø—Ç–µ—Ä—ã)

---

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤**: –ú–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å Gin –Ω–∞ Echo
2. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å**: –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ –ë–î –∏ HTTP
3. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç UI**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å CLI, gRPC, WebSocket –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è Use Cases
4. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ë–î**: –ú–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å Postgres –Ω–∞ Mongo

> [!TIP]
> **–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å**: –î–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –∏ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –¥–æ–ª–≥–æ–π –∂–∏–∑–Ω—å—é. –î–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω–æ.

---

## 2. ‚ö° CQRS

**Command and Query Responsibility Segregation** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –ß—Ç–µ–Ω–∏–µ –∏ –ó–∞–ø–∏—Å—å.

### ü§î –ó–∞—á–µ–º?
–û–±—ã—á–Ω–æ –º—ã —á–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≥–æ—Ä–∞–∑–¥–æ —á–∞—â–µ, —á–µ–º –ø–∏—à–µ–º. –í –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–¥–Ω—É –∏ —Ç—É –∂–µ –º–æ–¥–µ–ª—å (–∏ —Ç–∞–±–ª–∏—Ü—É –≤ –ë–î) –¥–ª—è `SELECT` –∏ –¥–ª—è `UPDATE`. –≠—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.

*   **Command (–ö–æ–º–∞–Ω–¥–∞)**: –ò–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ ("–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑", "–°–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å"). –°–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é.
*   **Query (–ó–∞–ø—Ä–æ—Å)**: –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–∞—è, —á–∞—Å—Ç–æ –≤–æ–æ–±—â–µ –±–µ–∑ –ª–æ–≥–∏–∫–∏, –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç DTO (Data Transfer Object).

### üèóÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?
–ß–∞—â–µ –≤—Å–µ–≥–æ CQRS –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–º–µ—Å—Ç–µ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö:
1.  **Write DB**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏ (—á–∞—Å—Ç–æ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è, –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è).
2.  **Read DB**: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è (NoSQL –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –¥–µ–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –∫–µ—à).

> [!WARNING]
> **Eventual Consistency (–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –≤ –∫–æ–Ω–µ—á–Ω–æ–º —Å—á–µ—Ç–µ)**: –ü–æ—Å–∫–æ–ª—å–∫—É –¥–∞–Ω–Ω—ã–µ –∏–∑ Write DB –ø–æ–ø–∞–¥–∞—é—Ç –≤ Read DB –Ω–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–æ–ª—é —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –≠—Ç–æ —Ü–µ–Ω–∞ –∑–∞ —Å–∫–æ—Ä–æ—Å—Ç—å.

---

## 3. üì° Event Driven Architecture (EDA)

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –≥–¥–µ —Å–∏—Å—Ç–µ–º—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ **—Å–æ–±—ã—Ç–∏—è**.

*   **–°–æ–±—ã—Ç–∏–µ (Event)**: –§–∞–∫—Ç, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Å–ª—É—á–∏–ª—Å—è ("OrderCreated", "PaymentReceived"). –ï–≥–æ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.
*   **–ë—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π**: Kafka, RabbitMQ, NATS.

### üéûÔ∏è Event Sourcing (ES)
–ú—ã –Ω–µ —Ö—Ä–∞–Ω–∏–º —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ë–∞–ª–∞–Ω—Å: 100"). –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã —Ö—Ä–∞–Ω–∏–º **—Ü–µ–ø–æ—á–∫—É –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π**, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤–µ–ª–∏ –∫ —ç—Ç–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é.

**–ü—Ä–∏–º–µ—Ä (–ë–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç):**
1. –°—á—ë—Ç –æ—Ç–∫—Ä—ã—Ç (+0)
2. –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ (+100)
3. –ü–æ–∫—É–ø–∫–∞ (-30)
*–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å (70) –≤—ã—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—É—Ç–µ–º —Å–ª–æ–∂–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π.*

*   **–ó–∞—á–µ–º?**: –ê—É–¥–∏—Ç, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "–æ—Ç–º–æ—Ç–∞—Ç—å" –≤—Ä–µ–º—è –Ω–∞–∑–∞–¥, –ª–µ–≥–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–æ–≤ (–∏—Å–ø—Ä–∞–≤–∏–ª–∏ –ª–æ–≥–∏–∫—É –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∏ —Å–æ–±—ã—Ç–∏—è).
*   **–°–ª–æ–∂–Ω–æ—Å—Ç—å**: –ù—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å **Snapshot'—ã** (—Å–Ω–∏–º–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è), —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –º–∏–ª–ª–∏–æ–Ω —Å–æ–±—ã—Ç–∏–π –∫–∞–∂–¥—ã–π —Ä–∞–∑.

---

## 4. üìú Saga Pattern

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö. –í –æ–±–ª–∞–∫–∞—Ö –Ω–µ–ª—å–∑—è —Å–¥–µ–ª–∞—Ç—å `BEGIN TRANSACTION ... COMMIT` —Å—Ä–∞–∑—É –Ω–∞ —Ç—Ä–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –°–∞–≥–∏:

### ü©∞ 4.1 –•–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏—è (Choreography)
–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è. –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.
*   **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –°–µ—Ä–≤–∏—Å –ê —Å–¥–µ–ª–∞–ª –¥–µ–ª–æ -> –∫–∏–Ω—É–ª —Å–æ–±—ã—Ç–∏–µ -> –°–µ—Ä–≤–∏—Å –ë —É—Å–ª—ã—à–∞–ª -> —Å–¥–µ–ª–∞–ª —Å–≤–æ—ë –¥–µ–ª–æ -> –∫–∏–Ω—É–ª —Å–æ–±—ã—Ç–∏–µ.
*   **–ü–ª—é—Å—ã**: –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Ç–æ—á–∫–∏ –æ—Ç–∫–∞–∑–∞, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å.
*   **–ú–∏–Ω—É—Å—ã**: –°–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç (–∑–∞–ø—É—Ç–∞–Ω–Ω–∞—è —Ü–µ–ø–æ—á–∫–∞), —Ä–∏—Å–∫ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

### üíÇ 4.2 –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è (Orchestration)
–ï—Å—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π "–¥–∏—Ä–∏–∂–µ—Ä" (Orchestrator), –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç –≤—Å–µ–º, —á—Ç–æ –¥–µ–ª–∞—Ç—å.
*   **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —à–ª–µ—Ç –∫–æ–º–∞–Ω–¥—É –°–µ—Ä–≤–∏—Å—É –ê -> –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç -> —à–ª–µ—Ç –∫–æ–º–∞–Ω–¥—É –°–µ—Ä–≤–∏—Å—É –ë.
*   **–ü–ª—é—Å—ã**: –í—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ, –ª–µ–≥–∫–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å.
*   **–ú–∏–Ω—É—Å—ã**: –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–æ–∂–Ω—ã–º –∏ –≤–∞–∂–Ω—ã–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º (–µ—Å–ª–∏ –æ–Ω —É–ø–∞–ª ‚Äî –ø—Ä–æ—Ü–µ—Å—Å –≤—Å—Ç–∞–ª).

---

## üéØ –ò—Ç–æ–≥: –ß—Ç–æ –≤—ã–±—Ä–∞—Ç—å?

| –°–∏—Ç—É–∞—Ü–∏—è | –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω |
| :--- | :--- |
| –ù—É–∂–Ω–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç –ë–î –∏ –≤–µ–±–∞ | **Clean Architecture / Hexagonal** |
| –û—á–µ–Ω—å –º–Ω–æ–≥–æ —á—Ç–µ–Ω–∏–π –∏ —Å–ª–æ–∂–Ω–∞—è –∑–∞–ø–∏—Å—å | **CQRS** |
| –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏ –∞—É–¥–∏—Ç | **Event Sourcing** |
| –°–ª–æ–∂–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –º–µ–∂–¥—É –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ | **Saga (Orchestration/Choreography)** |
| –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –∏ —Å–ª–∞–±–∞—è —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ | **Event Driven Architecture** |

## 5. üíâ Dependency Injection (DI) –∏ IoC

### üîÑ Inversion of Control (IoC)
"–ù–µ –∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º, –º—ã —Å–∞–º–∏ –≤–∞–º –ø–æ–∑–≤–æ–Ω–∏–º".
*   **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞**: –í—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∫–æ–¥–æ–º.
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫**: –§—Ä–µ–π–º–≤–æ—Ä–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞—à–∏–º –∫–æ–¥–æ–º (–≤—ã–∑—ã–≤–∞–µ—Ç –≤–∞—à–∏ —Ñ—É–Ω–∫—Ü–∏–∏).

### üîå Dependency Injection (DI)
–í–∞—à –∫–ª–∞—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`new Database()`). –û–Ω –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å –∏—Ö –∏–∑–≤–Ω–µ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä).

**–ü–ª–æ—Ö–æ (–ñ–µ—Å—Ç–∫–∞—è —Å—Ü–µ–ø–∫–∞):**
```go
type Service struct {
    db MySQLDatabase // –ó–∞–≤–∏—Å–∏–º –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î ‚ùå
}
```

**–•–æ—Ä–æ—à–æ (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏):**
```go
type Service struct {
    repo UserRepository // –ó–∞–≤–∏—Å–∏–º –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ‚úÖ
}
```

> [!TIP]
> **DIP (Dependency Inversion Principle)**: –ú–æ–¥—É–ª–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –º–æ–¥—É–ª–µ–π –Ω–∏–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è. –û–±–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π.