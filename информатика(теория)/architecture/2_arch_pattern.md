# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [Clean / Onion / Hexagonal Architecture](#1-clean--onion--hexagonal-architecture)
2. [CQRS (Command and Query Responsibility Segregation)](#2-cqrs)
3. [Event Driven Architecture](#3-event-driven-architecture)
4. [Saga Pattern](#4-saga-pattern)
5. [S.O.L.I.D. –∏ Dependency Injection](#5-solid-–∏-dependency-injection)

---

## 1. üßÖ Clean / Onion / Hexagonal Architecture

–í—Å–µ —ç—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (–õ—É–∫–æ–≤–∞—è, –ì–µ–∫—Å–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è, –ß–∏—Å—Ç–∞—è) –≥–æ–≤–æ—Ä—è—Ç –æ–± –æ–¥–Ω–æ–º –≥–ª–∞–≤–Ω–æ–º –ø—Ä–∞–≤–∏–ª–µ: **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ã –í–ù–£–¢–†–¨**.

### üß© –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è
–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Å–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å) –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ü–µ–Ω—Ç—Ä–µ –∏ **–Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—Ç—å** –æ –±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö, –≤–µ–±–µ –∏–ª–∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö. –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ —à—Ç—É–∫–∏ (–ë–î, API) –∑–∞–≤–∏—Å—è—Ç –æ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∞ –Ω–µ –Ω–∞–æ–±–æ—Ä–æ—Ç.

```mermaid
graph TD
    subgraph Infra ["Infrastructure Layer (–ë–î, Web, –§–∞–π–ª—ã)"]
        subgraph App ["Application Layer (Use Cases)"]
            subgraph Domain ["Domain Layer (–ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)"]
                Entities[–°—É—â–Ω–æ—Å—Ç–∏]
            end
        end
    end
    Infra --> App
    App --> Domain
    style Domain fill:#f9f,stroke:#333
```

### üç∞ –°–ª–æ–∏ (Layers)

#### 1. Domain Layer (–î–æ–º–µ–Ω–Ω—ã–π —Å–ª–æ–π) üß†
–°–µ—Ä–¥—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
*   **–ß—Ç–æ —Ç—É—Ç**: –ë–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏ (User, Order) –∏ —á–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞.
*   **–ü—Ä–∞–≤–∏–ª–æ**: –ù–µ –∑–∞–≤–∏—Å–∏—Ç –ù–ò –û–¢ –ß–ï–ì–û. –ù–∏–∫–∞–∫–∏—Ö SQL, HTTP –∏–ª–∏ JSON.

#### 2. Application Layer (–ü—Ä–∏–∫–ª–∞–¥–Ω–æ–π —Å–ª–æ–π) ü§ù
"–ö–ª–µ–π" –º–µ–∂–¥—É –º–∏—Ä–æ–º –∏ –¥–æ–º–µ–Ω–æ–º.
*   **–ß—Ç–æ —Ç—É—Ç**: –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (Use Cases), –Ω–∞–ø—Ä–∏–º–µ—Ä `CreateUserHandler`.
*   **–ü—Ä–∞–≤–∏–ª–æ**: –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É: "–î–æ—Å—Ç–∞—Ç—å —é–∑–µ—Ä–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è -> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∫–∏–¥–∫—É -> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å".

#### 3. Infrastructure Layer (–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞) üîå
–í–Ω–µ—à–Ω–∏–π –º–∏—Ä.
*   **–ß—Ç–æ —Ç—É—Ç**: –ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (Postgres, Redis), HTTP —Ö–µ–Ω–¥–ª–µ—Ä—ã, –≤–Ω–µ—à–Ω–∏–µ API.
*   **–ü—Ä–∞–≤–∏–ª–æ**: –†–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤–Ω—É—Ç—Ä–∏ (–≤ –¥–æ–º–µ–Ω–µ –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏).

#### 4. Presentation Layer (–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ) üñ•Ô∏è
–ß–∞—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã, –æ—Ç–≤–µ—á–∞—é—â–∞—è –∑–∞ UI.
*   **–ß—Ç–æ —Ç—É—Ç**: –í–µ–±-–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, CLI –∫–æ–º–∞–Ω–¥—ã.

---

## 2. ‚ö° CQRS

**Command and Query Responsibility Segregation** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞ –ß—Ç–µ–Ω–∏–µ –∏ –ó–∞–ø–∏—Å—å.

### ü§î –ó–∞—á–µ–º?
–û–±—ã—á–Ω–æ –º—ã —á–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≥–æ—Ä–∞–∑–¥–æ —á–∞—â–µ, —á–µ–º –ø–∏—à–µ–º. –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É –∏ —Ç—É –∂–µ –º–æ–¥–µ–ª—å –¥–ª—è –≤—Å–µ–≥–æ?

*   **Command (–ö–æ–º–∞–Ω–¥–∞)**: –ò–∑–º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ ("–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑"). –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ –º–∏–Ω–∏–º—É–º).
*   **Query (–ó–∞–ø—Ä–æ—Å)**: –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ ("–î–∞–π —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤"). –ù–µ –º–µ–Ω—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ.

```mermaid
graph LR
    User((User))
    User -->|Command: –°–æ–∑–¥–∞—Ç—å| Write[Service: Write Model]
    User -->|Query: –ü–æ–∫–∞–∑–∞—Ç—å| Read[Service: Read View]
    Write --> DB[(Master DB)]
    DB -.->|Replication| Cache[(Read DB / Cache)]
    Read --> Cache
```

> [!WARNING]
> **–≠—Ç–æ —Å–ª–æ–∂–Ω–æ!** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CQRS –≤–µ–∑–¥–µ. –≠—Ç–æ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã.

---

## 3. üì° Event Driven Architecture

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —É–ø—Ä–∞–≤–ª—è–µ–º–∞—è —Å–æ–±—ã—Ç–∏—è–º–∏. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—â–∞—é—Ç—Å—è –Ω–µ –ø—Ä—è–º—ã–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ (`service.doSomething()`), –∞ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è (`EventBus.publish(SomethingHappened)`).

### üéûÔ∏è Event Sourcing (ES)
–í–º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è *—Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è* (User Balance: 100), –º—ã —Ö—Ä–∞–Ω–∏–º *–∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π*:
1. `UserCreated`
2. `MoneyDeposited(50)`
3. `MoneyDeposited(50)`

–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å, –º—ã –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º" –≤—Å–µ —Å–æ–±—ã—Ç–∏—è.

*   **–ü–ª—é—Å—ã**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è, –º–∞—à–∏–Ω—É –≤—Ä–µ–º–µ–Ω–∏ –º–æ–∂–Ω–æ –æ—Ç–º–æ—Ç–∞—Ç—å –Ω–∞–∑–∞–¥.
*   **–ú–∏–Ω—É—Å—ã**: –°–ª–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ (Snapshot'—ã –ø–æ–º–æ–≥–∞—é—Ç).

---

## 4. üìú Saga Pattern

–ö–∞–∫ –¥–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö? `ACID` —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∫–∞–∫ –≤ SQL) —Ç–∞–º –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç. –ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç **Saga**.

**Saga** ‚Äî —ç—Ç–æ —Ü–µ–ø–æ—á–∫–∞ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è **–∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è** (–æ—Ç–∫–∞—Ç).

### –ü—Ä–∏–º–µ—Ä: –ü–æ–∫—É–ø–∫–∞ —Ç—É—Ä–∞ ‚úàÔ∏èüè®

1.  **–°–µ—Ä–≤–∏—Å –ë–∏–ª–µ—Ç–æ–≤**: –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–∞–º–æ–ª–µ—Ç ‚úÖ
2.  **–°–µ—Ä–≤–∏—Å –û—Ç–µ–ª—è**: –ó–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–µ–ª—å ‚úÖ
3.  **–°–µ—Ä–≤–∏—Å –ú–∞—à–∏–Ω—ã**: –ê—Ä–µ–Ω–¥–∞ –∞–≤—Ç–æ... ‚ùå –û—à–∏–±–∫–∞! –ú–∞—à–∏–Ω –Ω–µ—Ç.

**–û—Ç–∫–∞—Ç (Compensating Transactions)**:
*   3 -> (–û—à–∏–±–∫–∞)
*   2 -> **–û—Ç–º–µ–Ω–∏—Ç—å** –±—Ä–æ–Ω—å –æ—Ç–µ–ª—è ‚Ü©Ô∏è
*   1 -> **–û—Ç–º–µ–Ω–∏—Ç—å** –±—Ä–æ–Ω—å —Å–∞–º–æ–ª–µ—Ç–∞ ‚Ü©Ô∏è

---

## 5. üíâ Dependency Injection (DI) –∏ IoC

### üîÑ Inversion of Control (IoC)
"–ù–µ –∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º, –º—ã —Å–∞–º–∏ –≤–∞–º –ø–æ–∑–≤–æ–Ω–∏–º".
*   **–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞**: –í—ã —É–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∫–æ–¥–æ–º.
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫**: –§—Ä–µ–π–º–≤–æ—Ä–∫ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∞—à–∏–º –∫–æ–¥–æ–º (–≤—ã–∑—ã–≤–∞–µ—Ç –≤–∞—à–∏ —Ñ—É–Ω–∫—Ü–∏–∏).

### üîå Dependency Injection (DI)
–í–∞—à –∫–ª–∞—Å—Å –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`new Database()`). –û–Ω –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å –∏—Ö –∏–∑–≤–Ω–µ (—á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä).

**–ü–ª–æ—Ö–æ (–ñ–µ—Å—Ç–∫–∞—è —Å—Ü–µ–ø–∫–∞):**
```go
type Service struct {
    db MySQLDatabase // –ó–∞–≤–∏—Å–∏–º –æ—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ë–î ‚ùå
}
```

**–•–æ—Ä–æ—à–æ (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏):**
```go
type Service struct {
    repo UserRepository // –ó–∞–≤–∏—Å–∏–º –æ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ ‚úÖ
}
```

> [!TIP]
> **DIP (Dependency Inversion Principle)**: –ú–æ–¥—É–ª–∏ –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –Ω–µ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –º–æ–¥—É–ª–µ–π –Ω–∏–∂–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è. –û–±–∞ –¥–æ–ª–∂–Ω—ã –∑–∞–≤–∏—Å–µ—Ç—å –æ—Ç –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–π.