# üìÇ File System & Descriptors (–§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã)

–í Linux –≤—Å—ë —Å—Ç—Ä–æ–∏—Ç—Å—è –≤–æ–∫—Ä—É–≥ –æ–¥–Ω–æ–π –∏–¥–µ–∏: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±—ã–º —Ä–µ—Å—É—Ä—Å–æ–º –∫–∞–∫ —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –±–∞–π—Ç–æ–≤.

---

## 1. üìÑ –ì–ª–∞–≤–Ω–∞—è —Ñ–∏–ª–æ—Å–æ—Ñ–∏—è: Everything is a file

–í Linux –≤—Å—ë –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–æ –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤:
- **–¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –±–∏–Ω–∞—Ä–Ω—ã–µ —Ñ–∞–π–ª—ã.**
- **–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏** (—ç—Ç–æ —Ñ–∞–π–ª—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —Å–ø–∏—Å–æ–∫ –∏–º–µ–Ω –¥—Ä—É–≥–∏—Ö —Ñ–∞–π–ª–æ–≤).
- **–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞, –¥–∏—Å–∫–∏ ‚Äî `/dev/sda`).
- **–°–æ–∫–µ—Ç—ã –∏ –ø–∞–π–ø—ã** (—Å—Ä–µ–¥—Å—Ç–≤–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏).

---

## 2. üè∑ Inode (–ò–Ω–¥–µ–∫—Å–Ω—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä)

**Inode** ‚Äî —ç—Ç–æ ¬´–ø–∞—Å–ø–æ—Ä—Ç¬ª —Ñ–∞–π–ª–∞ –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ.
- –•—Ä–∞–Ω–∏—Ç: —Ç–∏–ø —Ñ–∞–π–ª–∞, –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞, –≤–ª–∞–¥–µ–ª—å—Ü–∞, —Ä–∞–∑–º–µ—Ä, –≤—Ä–µ–º—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É–∫–∞–∑–∞—Ç–µ–ª–∏ –Ω–∞ –±–ª–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫–µ.
- **–ù–µ —Ö—Ä–∞–Ω–∏—Ç**: –ò–º—è —Ñ–∞–π–ª–∞ (–æ–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏).
- –ö–æ–≥–¥–∞ –≤—ã –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ —Ñ–∞–π–ª `/home/user/test.txt`, —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ö–æ–¥–∏—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `user` –∏–º—è `test.txt` –∏ —É–∑–Ω–∞–µ—Ç –µ–≥–æ –Ω–æ–º–µ—Ä Inode, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ—Ç–æ–º –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –¥–∞–Ω–Ω—ã–º.

---

## 3. üîç –§–∞–π–ª–æ–≤—ã–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (FD) üõ†Ô∏è

–ï—Å–ª–∏ Inode ‚Äî —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞ –¥–∏—Å–∫–µ, —Ç–æ **File Descriptor** ‚Äî —ç—Ç–æ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –ø–∞–º—è—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞.

**FD** ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ (0, 1, 2, 3...), –∫–æ—Ç–æ—Ä–æ–µ —è–¥—Ä–æ –≤—ã–¥–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–µ. –î–ª—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —ç—Ç–æ ¬´—Ä—É—á–∫–∞¬ª, –∑–∞ –∫–æ—Ç–æ—Ä—É—é –æ–Ω –¥–µ—Ä–≥–∞–µ—Ç, —á—Ç–æ–±—ã –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∏–ª–∏ –∑–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ.

### üö© –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (—É –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞):
| FD | –ò–º—è | –ö—É–¥–∞ —Å–º–æ—Ç—Ä–∏—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|:---:|:---|:---|
| **0** | `stdin` | –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (–≤–≤–æ–¥) |
| **1** | `stdout` | –¢–µ—Ä–º–∏–Ω–∞–ª (–≤—ã–≤–æ–¥) |
| **2** | `stderr` | –¢–µ—Ä–º–∏–Ω–∞–ª (–æ—à–∏–±–∫–∏) |

---

## 4. üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω—É—Ç—Ä–∏) üî¨

–ö–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ FD, —è–¥—Ä–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Ç—Ä–∏ —É—Ä–æ–≤–Ω—è:

```mermaid
flowchart LR
    subgraph "–ü—Ä–æ—Ü–µ—Å—Å (User Space)"
        A["FD Table (–ú–∞—Å—Å–∏–≤ –∏–Ω–¥–µ–∫—Å–æ–≤)"]
    end
    
    subgraph "–Ø–¥—Ä–æ (Kernel Space)"
        B["Global File Table (–°–æ—Å—Ç–æ—è–Ω–∏–µ: —Å–º–µ—â–µ–Ω–∏–µ, —Ñ–ª–∞–≥–∏)"]
        C["Inode Table (–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª–∞)"]
    end
    
    A -- "–ò–Ω–¥–µ–∫—Å" --> B
    B -- "–£–∫–∞–∑–∞—Ç–µ–ª—å" --> C
```

1.  **Descriptor Table**: –£ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–≤–æ—è. –•—Ä–∞–Ω–∏—Ç —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—â—É—é —Ç–∞–±–ª–∏—Ü—É.
2.  **Global File Table**: –û–±—â–∞—è –¥–ª—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã. –•—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â—É—é **–ø–æ–∑–∏—Ü–∏—é —á—Ç–µ–Ω–∏—è/–∑–∞–ø–∏—Å–∏** (offset) –∏ —Ñ–ª–∞–≥–∏ (–±—ã–ª –ª–∏ —Ñ–∞–π–ª –æ—Ç–∫—Ä—ã—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è –∏–ª–∏ –∑–∞–ø–∏—Å–∏).
3.  **Inode Table**: –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

---

## üìö –ê–Ω–∞–ª–æ–≥–∏—è: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ **–Ø–¥—Ä–æ** ‚Äî —ç—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞.
1.  –í—ã (–ü—Ä–æ—Ü–µ—Å—Å) –ø—Ä–æ—Å–∏—Ç–µ –∫–Ω–∏–≥—É (–æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª).
2.  –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –≤—ã–¥–∞–µ—Ç –≤–∞–º **–Ω–æ–º–µ—Ä –∂–µ—Ç–æ–Ω–∞** (FD = 3).
3.  –í—ã –≥–æ–≤–æ—Ä–∏—Ç–µ: ¬´–ü—Ä–æ—á–∏—Ç–∞–π –º–Ω–µ 10 —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ –∫–Ω–∏–≥–∏ –Ω–æ–º–µ—Ä 3¬ª.
4.  –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ä—å –ø–æ–º–Ω–∏—Ç, —á—Ç–æ –≤—ã –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å –Ω–∞ 50-–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ (—ç—Ç–æ **offset** –≤ Global File Table).
5.  –ï—Å–ª–∏ –≤–∞—à –¥—Ä—É–≥ –æ—Ç–∫—Ä–æ–µ—Ç —Ç—É –∂–µ –∫–Ω–∏–≥—É, –æ–Ω –ø–æ–ª—É—á–∏—Ç **—Å–≤–æ–π** –∂–µ—Ç–æ–Ω, –∏ –µ–≥–æ 50-—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –±—É–¥–µ—Ç –º–µ—à–∞—Ç—å –≤–∞—à–µ–π.

---

## üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã üïπÔ∏è
- `ls -l /proc/self/fd` ‚Äî –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞.
- `lsof` ‚Äî (list open files) –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –≤ —Å–∏—Å—Ç–µ–º–µ.
- `ulimit -n` ‚Äî —É–∑–Ω–∞—Ç—å –ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (–æ–±—ã—á–Ω–æ 1024).
