# ğŸ›¡ï¸ Security: Best Practices and Common Threats

## ğŸ“‘ Table of Contents
1. [OWASP Top 10](#owasp-top-10)
2. [SQL Injections](#sql-injections)
3. [Cross-Site Scripting (XSS)](#xss)
4. [Cross-Site Request Forgery (CSRF)](#csrf)
5. [Secure Password Storage](#password-storage)
6. [General Best Practices for Developers](#general-tips)

---

## ğŸš© OWASP Top 10

The **Open Web Application Security Project (OWASP)** is a non-profit foundation that works to improve software security. Every few years, they publish a list of the 10 most critical web application security risks. This list is the "bible" of security for modern developers.

### The Top 10 (2021) Highlights:

1. **Broken Access Control**: Improper verification of user permissions.
2. **Cryptographic Failures**: Weak encryption or unprotected sensitive data.
3. **Injection**: SQL, NoSQL, and LDAP injection.
4. **Insecure Design**: Risks related to design and architectural flaws.
5. **Security Misconfiguration**: Insecure default settings or open ports.

---

## ğŸ’‰ SQL Injections

An **SQL Injection** occurs when a malicious actor inserts rogue SQL code into an input field, which is then executed by your database.

### âŒ Dangerous Code (String Concatenation):
```go
// DANGEROUS! Vulnerable to SQL injection
query := "SELECT * FROM users WHERE name = '" + userInput + "'"
db.QueryRow(query)
```

### âœ… Secure Code (Prepared Statements):
```go
// SECURE: Use placeholders (?)
query := "SELECT id, name FROM users WHERE name = ?"
db.QueryRow(query, userInput) // The driver handles sanitization
```

> [!CAUTION]
> Never concatenate strings to build SQL queries manually. Always use **Prepared Statements** or a trusted **ORM** (like GORM).

---

## ğŸ“œ XSS (Cross-Site Scripting)

**XSS** involves injecting malicious JavaScript into a web page that other users will then view. This can be used to steal session cookies or perform actions on behalf of the user.

### âœ… Secure Code (HTML Escaping):
In Go, the `html/template` package automatically escapes data to prevent XSS.
```go
import "html/template"

tmpl := template.Must(template.New("view").Parse(`<div>{{.}}</div>`))
tmpl.Execute(w, userInput) // <script> becomes &lt;script&gt;
```

---

## ğŸ•µï¸â€â™‚ï¸ CSRF (Cross-Site Request Forgery)

**CSRF** is an attack that tricks a user's browser into sending a malicious request to a website where the user is currently authenticated (e.g., clicking a link that triggers a money transfer in their bank app).

### âœ… Defense: CSRF Tokens
Ensure every state-changing request (POST, PUT, DELETE) includes a unique, secret token that the server validates. Additionally, use the `SameSite=Strict` attribute on your session cookies.

---

## ğŸ” Secure Password Storage

### âŒ NEVER do this:
- Store passwords in plain text (Catastrophic).
- Use fast hash algorithms like MD5 or SHA1 (Easy to crack with brute force).

### âœ… Do this: Use Argon2 or Bcrypt
These are "slow" hash functions designed specifically for passwords. They include a "Salt" (random data) by default to prevent rainbow table attacks.

```go
import "golang.org/x/crypto/bcrypt"

// Hashing upon registration
hash, _ := bcrypt.GenerateFromPassword([]byte(password), 12)

// Verifying upon login
err := bcrypt.CompareHashAndPassword(hash, []byte(password))
```

---

## ğŸ› ï¸ General Security Best Practices

1. **Principle of Least Privilege**: Your application's database user should only have the minimum permissions necessary (e.g., no `DROP TABLE` rights).
2. **Sanitize Everything**: Never trust any data coming from a user. Validate formats (emails, dates) and sanitize strings.
3. **Keep Secrets Secret**: Use environment variables or a secret manager. Never hardcode API keys or database passwords in your source code.
4. **Rate Limiting**: Protect your login and sensitive endpoints from brute-force attacks by limiting the number of requests per IP address.
5. **Secure Headers**: Implement security headers like `Content-Security-Policy` (CSP) and `X-Frame-Options` to protect against various clickjacking and injection attacks.

---

## ğŸ¯ Summary Checklist

| Threat | Primary Defense | Go Example |
|:---|:---|:---|
| **SQL Injection** | Prepared Statements | `db.QueryRow("...", id)` |
| **XSS** | HTML Escaping | `html/template` |
| **CSRF** | Tokens + SameSite | `SameSite: Strict` cookie |
| **Brute Force** | Rate Limiting | Request throttling |
| **Data Leakage** | HTTPS | `ListenAndServeTLS` |

> [!IMPORTANT]
> Security is not a one-time setup; it is a continuous mindset. Always assume that any user input could be malicious. ğŸ›¡ï¸
