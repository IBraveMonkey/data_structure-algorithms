# üíª –°–µ—Ç–∏: –ü—Ä–∞–∫—Ç–∏–∫–∞ –¥–ª—è –±—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ö–∞–∫ —Å–µ—Ç–∏ –≤–ª–∏—è—é—Ç –Ω–∞ –∫–æ–¥](#–∫–∞–∫-—Å–µ—Ç–∏-–≤–ª–∏—è—é—Ç-–Ω–∞-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π)
2. [–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –∏ Service Discovery](#–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã)
3. [–ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ (Circuit Breaker, Retries)](#—Å–µ—Ç–µ–≤—ã–µ-–∞—Å–ø–µ–∫—Ç—ã)
4. [–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–°–∂–∞—Ç–∏–µ, HTTP/2, gRPC)](#–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è-—Å–µ—Ç–µ–≤—ã—Ö-–∑–∞–ø—Ä–æ—Å–æ–≤)

---

–ë—ç–∫–µ–Ω–¥-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∂–∏–≤–µ—Ç –≤ –º–∏—Ä–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –î–∞–∂–µ –∑–∞–ø—Ä–æ—Å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ Redis ‚Äî —ç—Ç–æ —Å–µ—Ç–µ–≤–æ–π –≤—ã–∑–æ–≤.

---

## 1. ‚è≥ –°–µ—Ç–µ–≤—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

–í –∏–¥–µ–∞–ª—å–Ω–æ–º –º–∏—Ä–µ —Å–µ—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–∞ –∏ –Ω–∞–¥–µ–∂–Ω–∞. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏:
- **–ó–∞–¥–µ—Ä–∂–∫–∞ (Latency)**: –£–±–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å. 100 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ 10–º—Å = 1 —Å–µ–∫—É–Ω–¥–∞ –æ–∂–∏–¥–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- **–ü–æ—Ç–µ—Ä–∏ (Packet Loss)**: –ü—Ä–∏–≤–æ–¥—è—Ç –∫ —Ç–∞–π–º–∞—É—Ç–∞–º –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–º —Ä–µ—Ç—Ä–∞–Ω—Å–º–∏—Å—Å–∏—è–º TCP.

### –ß—Ç–æ –¥–µ–ª–∞—Ç—å?
- **Batching**: –í–º–µ—Å—Ç–æ 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É ID, —Å–¥–µ–ª–∞–π—Ç–µ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞ 10 ID.
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

```mermaid
graph LR
    subgraph Bad["–ú–µ–¥–ª–µ–Ω–Ω–æ (–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ)"]
        A1[–ó–∞–ø—Ä–æ—Å 1] --> A2[–ó–∞–ø—Ä–æ—Å 2] --> A3[–ó–∞–ø—Ä–æ—Å 3]
    end
    
    subgraph Good["–ë—ã—Å—Ç—Ä–æ (–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ)"]
        B1[–ó–∞–ø—Ä–æ—Å 1]
        B2[–ó–∞–ø—Ä–æ—Å 2]
        B3[–ó–∞–ø—Ä–æ—Å 3]
    end
```

---

## 2. üß± –ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –∏ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç –≤—ã–∑–æ–≤—ã —Ñ—É–Ω–∫—Ü–∏–π –≤ —Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã.

| –¢–∏–ø | –ü—Ä–æ—Ç–æ–∫–æ–ª | –ü–ª—é—Å—ã |
|:---|:---:|:---|
| **REST** | HTTP/1.1 / JSON | –ü—Ä–æ—Å—Ç–æ, –ø–æ–Ω—è—Ç–Ω–æ –≤—Å–µ–º. |
| **gRPC** | HTTP/2 / Protobuf | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ, —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. |
| **Messaging** | Kafka / RabbitMQ | –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–∞–¥–µ–∂–Ω–æ (–æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞). |

---

## 3. üõ°Ô∏è –ü–∞—Ç—Ç–µ—Ä–Ω—ã –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

–°–µ—Ç—å **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** —É–ø–∞–¥–µ—Ç. –í–æ–ø—Ä–æ—Å –≤ —Ç–æ–º, –≥–æ—Ç–æ–≤ –ª–∏ –≤–∞—à –∫–æ–¥.

### Retries (–ü–æ–≤—Ç–æ—Ä—ã)
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —É–ø–∞–ª, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.
> [!CAUTION]
> **Exponential Backoff**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–π—Ç–µ –ø–∞—É–∑—É –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏ (1—Å, 2—Å, 4—Å...), –∏–Ω–∞—á–µ –≤—ã –¥–æ–±—å–µ—Ç–µ —É–ø–∞–≤—à–∏–π —Å–µ—Ä–≤–µ—Ä –ª–∞–≤–∏–Ω–æ–π –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### Circuit Breaker (–ü—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å)
–ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å –ë –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç 5 —Ä–∞–∑ –ø–æ–¥—Ä—è–¥, –ø–µ—Ä–µ—Å—Ç–∞–Ω—å—Ç–µ —Å–ª–∞—Ç—å –Ω–∞ –Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ 1 –º–∏–Ω—É—Ç—É, —á—Ç–æ–±—ã –¥–∞—Ç—å –µ–º—É "–ø—Ä–∏–π—Ç–∏ –≤ —Å–µ–±—è".

```mermaid
stateDiagram-v2
    [*] --> Closed: –†–∞–±–æ—Ç–∞–µ–º –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ
    Closed --> Open: –ú–Ω–æ–≥–æ –æ—à–∏–±–æ–∫
    Open --> HalfOpen: –ü—Ä–æ—à–ª–æ –≤—Ä–µ–º—è (—Ç–∞–π–º–∞—É—Ç)
    HalfOpen --> Closed: –û—Ç–≤–µ—Ç—ã —É—Å–ø–µ—à–Ω—ã
    HalfOpen --> Open: –°–Ω–æ–≤–∞ –æ—à–∏–±–∫–∞
```

---

## 4. üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ç–∏

- **Keep-Alive**: –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ TCP-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–æ–≤–æ–≥–æ TLS-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è ‚Äî —ç—Ç–æ –û–ß–ï–ù–¨ –¥–æ—Ä–æ–≥–æ.
- **–°–∂–∞—Ç–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gzip –∏–ª–∏ Brotli –¥–ª—è JSON.
- **HTTP/2**: –ú—É–ª—å—Ç–∏–ø–ª–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–ª–∞—Ç—å –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ –æ–¥–Ω–æ–π "—Ç—Ä—É–±–µ" –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

- –°–µ—Ç–µ–≤–æ–π –≤—ã–∑–æ–≤ –≤ 1000 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø–∞–º—è—Ç–∏.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Retries** —Å —É–º–æ–º (Backoff + Jitter).
- **gRPC** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ–±—â–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤.
- **Keep-Alive** ‚Äî –≤–∞—à –ª—É—á—à–∏–π –¥—Ä—É–≥ –≤ —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.
