# üê≥ Docker: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

## üìë –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
1. [–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Docker: –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º](#–∫–∞–∫-—Ä–∞–±–æ—Ç–∞–µ—Ç-docker-–ø–æ–¥-–∫–∞–ø–æ—Ç–æ–º)
2. [–ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (Daemon, Images, Volumes)](#–∫–ª—é—á–µ–≤—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-docker)
3. [–†–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—è–º–∏](#5-networks-—Å–µ—Ç–∏)
4. [Docker Compose](#docker-compose)
5. [Docker –¥–ª—è Go-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞](#–∫–∞–∫-—ç—Ç–æ-—Ä–∞–±–æ—Ç–∞–µ—Ç-–≤-go-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)
6. [Best Practices](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

**Docker** ‚Äî —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–µ-—Ñ–∞–∫—Ç–æ –¥–ª—è —É–ø–∞–∫–æ–≤–∫–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å "—Å–ª–µ–ø–æ–∫" —Å–∏—Å—Ç–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∞ –≤–∞—à–µ–º –Ω–æ—É—Ç–±—É–∫–µ, —Å–µ—Ä–≤–µ—Ä–µ –∫–æ–ª–ª–µ–≥–∏ –∏–ª–∏ –≤ –æ–±–ª–∞–∫–µ.

---

## 1. ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Docker: –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º

Docker –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–æ–π. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —è–¥—Ä–æ —Ö–æ—Å—Ç–æ–≤–æ–π –û–° –∏ –∏–∑–æ–ª–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å—ã.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Client-Server)
```mermaid
graph LR
    Client[Docker CLI / UI] -- API --> Host[Docker Host / Daemon]
    Host -- Pull --> Registry[Docker Hub / GCR]
    Host -- Run --> Containers[Containers L1, L2...]
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏–∑–æ–ª—è—Ü–∏–∏
- **Namespaces**: –†–µ—à–∞–µ—Ç, –ß–¢–û –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å (—Å–≤–æ–∏ –ø—Ä–æ—Ü–µ—Å—Å—ã, —Å–≤–æ—é —Å–µ—Ç—å).
- **Cgroups**: –†–µ—à–∞–µ—Ç, –°–ö–û–õ–¨–ö–û —Ä–µ—Å—É—Ä—Å–æ–≤ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–ª—è—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (CPU, RAM).
- **OverlayFS**: –°–ª–æ–∏—Å—Ç–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞. –ï—Å–ª–∏ –¥–≤–∞ –æ–±—Ä–∞–∑–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω —Å–ª–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ubuntu`), –æ–Ω —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ –≤ –æ–¥–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ.

---

## 2. üß© –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### –û–±—Ä–∞–∑—ã (Images) –∏ –°–ª–æ–∏
–û–±—Ä–∞–∑ ‚Äî —ç—Ç–æ "–º–∞—Ç—Ä–µ—à–∫–∞" –∏–∑ —Å–ª–æ–µ–≤. –ö–∞–∂–¥—ã–π `RUN`, `COPY`, `ADD` –≤ Dockerfile —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π —Å–ª–æ–π.

```mermaid
stack
    direction TB
    layer1["ReadOnly: OS Base (Alpine/Ubuntu)"]
    layer2["ReadOnly: Dependencies (Python/Go)"]
    layer3["ReadOnly: Application Code"]
    layer4["Read-Write: Container Layer (Runtime)"]
```

> [!TIP]
> **–ü—Ä–∏–Ω—Ü–∏–ø –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**: –†–∞–∑–º–µ—â–∞–π—Ç–µ —Ä–µ–¥–∫–æ –º–µ–Ω—è—é—â–∏–µ—Å—è –∫–æ–º–∞–Ω–¥—ã (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π) –≤ –Ω–∞—á–∞–ª–µ Dockerfile, –∞ —á–∞—Å—Ç–æ –º–µ–Ω—è—é—â–∏–µ—Å—è (–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞) ‚Äî –≤ –∫–æ–Ω—Ü–µ. –≠—Ç–æ —É—Å–∫–æ—Ä–∏—Ç —Å–±–æ—Ä–∫—É.

### –î–∞–Ω–Ω—ã–µ: Volumes –∏ Bind Mounts
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —ç—Ñ–∏–º–µ—Ä–Ω—ã (–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–ø–∞–¥–∞—é—Ç –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏). –î–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º:
- **Volumes**: –£–ø—Ä–∞–≤–ª—è—é—Ç—Å—è Docker, —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Å–ø–µ—Ü. –ø–∞–ø–∫–µ. –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ.
- **Bind Mounts**: –ü—Ä—è–º–∞—è –ø—Ä–∏–≤—è–∑–∫–∞ –ø–∞–ø–∫–∏ —Å —Ö–æ—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ–Ω—Ñ–∏–≥–∏ –∏–ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏).

---

## 3. üåê –°–µ—Ç–∏ (Networking)

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|:---|:---|:---|
| **Bridge** | –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–æ—Å—Ç (–ø–æ–¥—Å–µ—Ç—å). | –°—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. |
| **Host** | –£–±–∏—Ä–∞–µ—Ç –∏–∑–æ–ª—è—Ü–∏—é —Å–µ—Ç–∏ (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä = —Ö–æ—Å—Ç). | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, –Ω–µ—Ç –ø–æ—Ä—Ç–æ–≤ –ø—Ä–æ–±—Ä–æ—Å–∞. |
| **None** | –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è. | –ó–∞–¥–∞—á–∏, –Ω–µ —Ç—Ä–µ–±—É—é—â–∏–µ —Å–µ—Ç–∏. |

---

## 4. üîó Docker Compose

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ "–ø–∞—á–∫–∏" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π.

```yaml
version: "3.8"
services:
  api:
    build: .
    ports: ["8080:8080"]
    depends_on: ["db"]
  db:
    image: postgres:15-alpine
    volumes: ["db-data:/var/lib/postgresql/data"]

volumes:
  db-data:
```

---

## 5. üêπ Docker –¥–ª—è Go-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–î–ª—è Go –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç **Multi-stage build**. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ –≤–µ—Å–æ–º –≤ 15-20 –ú–ë –≤–º–µ—Å—Ç–æ 1 –ì–ë.

```dockerfile
# –≠—Ç–∞–ø 1: –°–±–æ—Ä–∫–∞
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY . .
RUN go build -o main .

# –≠—Ç–∞–ø 2: –§–∏–Ω–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑
FROM alpine:latest
WORKDIR /root/
COPY --from=builder /app/main .
CMD ["./main"]
```

---

## 6. üõ°Ô∏è Best Practices –∏ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

> [!CAUTION]
> **–ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –æ—Ç root**. –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã ‚Äî root. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é `USER` –≤ Dockerfile, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø—Ä–∞–≤–∞ –≤ —Å–ª—É—á–∞–µ –≤–∑–ª–æ–º–∞.

- **Alpine images**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `-alpine` –≤–µ—Ä—Å–∏–∏ –æ–±—Ä–∞–∑–æ–≤ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –∏ –¥—ã—Ä –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
- **.dockerignore**: –í—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–π—Ç–µ `.git`, `node_modules`, `vendor` –∏ –±–∏–Ω–∞—Ä–Ω–∏–∫–∏ –≤ –∏–≥–Ω–æ—Ä.
- **ReadOnly FS**: –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –Ω–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å –Ω–∞ –¥–∏—Å–∫, –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –µ–≥–æ —Å —Ñ–ª–∞–≥–æ–≤ `--read-only`.

---

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã (–®–ø–∞—Ä–≥–∞–ª–∫–∞)

- `docker ps -a` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.
- `docker images` ‚Äî —Å–ø–∏—Å–æ–∫ –æ–±—Ä–∞–∑–æ–≤.
- `docker exec -it <id> sh` ‚Äî –∑–∞–π—Ç–∏ –≤–Ω—É—Ç—Ä—å —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
- `docker system prune` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!).
- `docker logs -f <id>` ‚Äî —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
